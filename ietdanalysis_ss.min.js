let g_DataTable_HPCP_SUM=null;let g_DatePicker_beginningdate=null;let g_DatePicker_endingdate=null;let g_AnalyzedIETDData=null;let g_RawHPCPData=null;let g_ZoomingEnabled=false;let g_PreviousTimeRangeWhenZoomingActivated=[];const INNERPADDING=.05,OUTERPADDING=.05;const MARGIN={top:20,right:20,bottom:50,left:60};const BARCHART_POSITION={title_y:10};let g_PlotMonthPrecipitation=null;let g_PlotIDFCurve=null;let g_plotAnnualMaximumPrecipitation=null;let g_plotTopTenLargestPrecipitation=null;let g_plotTopTenLongestPrecipitation=null;let g_plotVolumetricHydrology=null;let g_plotTrendAnalysis=null;let g_plotAnomaly=null;let g_plotexceedanceprobabilty=null;let g_plotAnnualCycle=null;let g_plotSeasonalPCA=null;let g_plotMonthlyBox=null;async function downloadIETDData(){try{showFullPageSpinner();const fileName=getFileName();const exportData=g_DataTable_HPCP_SUM.buttons.exportData({modifier:{search:"applied",order:"applied"}});let csv="";csv+=exportData.header.join(",")+"\r\n";exportData.body.forEach(function(row){const safeRow=row.map(field=>{if(typeof field==="string"&&field.includes(",")){return`"${field.replace(/"/g,'""')}"`}return field});csv+=safeRow.join(",")+"\r\n"});const blob=new Blob([csv],{type:"text/csv;charset=utf-8"});const url=window.URL.createObjectURL(blob);const a=document.createElement("a");a.style.display="none";a.href=url;a.download=fileName;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);hideFullPageSpinner();showNotification("Download complete",`Your data has been downloaded as "${fileName}".`)}catch(error){console.error("Download error:",error);hideFullPageSpinner();showNotification("Download error","There was a problem with your download. Please try again.");try{const originalButtonTitle=g_DataTable_HPCP_SUM.button(".buttons-csv").text();g_DataTable_HPCP_SUM.button(".buttons-csv").text(`Export as ${fileName}`);g_DataTable_HPCP_SUM.button(".buttons-csv").trigger();setTimeout(()=>{g_DataTable_HPCP_SUM.button(".buttons-csv").text(originalButtonTitle)},1e3)}catch(fallbackError){console.error("Fallback download error:",fallbackError)}}}function getFileName(){const state=document.getElementById("state").value;const fromDate=document.getElementById("beginningdate").value;const toDate=document.getElementById("endingdate").value;const e=document.getElementById("station");let stationName=e.options[e.selectedIndex].text;stationName=stationName.split("(")[0];stationName=stationName.trim();const formattedStationName=stationName.replace(/\|/g,"-");const formattedState=state.toUpperCase();const fileName=`${formattedState}-${formattedStationName}-${fromDate}-${toDate}_IETD.csv`;return fileName}function getParams(){let e=document.getElementById("station");let station_name=e.options[e.selectedIndex].text;station_name=station_name.split("(")[0];station_name=station_name.trim();const state=document.getElementById("state").value;const station=document.getElementById("station").value;const ietd=document.getElementById("ietd").value;const beginningdate=document.getElementById("beginningdate").value;const endingdate=document.getElementById("endingdate").value;const param="state="+encodeURIComponent(state)+"&station="+encodeURIComponent(station)+"&name="+encodeURIComponent(station_name)+"&ietd="+encodeURIComponent(ietd)+"&from="+encodeURIComponent(beginningdate)+"&to="+encodeURIComponent(endingdate);return param}async function downloadOriginalHP(){try{if(validateForm()===false)return;const param=getParams();showFullPageSpinner();const response=await fetch("ietdanalysis_ss_dndata.php?"+param);if(!response.ok){throw new Error(`HTTP error! status: ${response.status}`)}const contentDisposition=response.headers.get("Content-Disposition");let filename="download.csv";if(contentDisposition){const filenameMatch=contentDisposition.match(/filename="?([^"]*)"?/);if(filenameMatch&&filenameMatch[1]){filename=filenameMatch[1]}}const blob=await response.blob();const url=window.URL.createObjectURL(blob);const a=document.createElement("a");a.style.display="none";a.href=url;a.download=filename;document.body.appendChild(a);a.click();window.URL.revokeObjectURL(url);document.body.removeChild(a);hideFullPageSpinner();showNotification("Download successful",`Your file has been downloaded as "${filename}".`)}catch(error){console.error("Download error:",error);hideFullPageSpinner();showNotification("Download error","There was a problem with your download. Please try again.")}}function runietdanalysis(){if(validateForm()===false)return;showFullPageSpinner();try{destroyAllCharts();const param=getParams();const dataPromise=new Promise((resolve,reject)=>{$.getJSON("ietdanalysis_ss_data.php?callback=?&"+param).done(function(data){resolve(data)}).fail(function(error){reject(error)})});dataPromise.then(function(data){showAllCharts(true);ShowHideDiv("chart_hpcp_ietd_avg",false);ShowHideDiv("chart_hpcp_hourlydata",false);analyzeHPCPAnalyzeData(data)}).catch(function(error){console.error("Error loading data:",error)}).finally(function(){hideFullPageSpinner()})}catch(error){console.error("Error in runietdanalysis:",error);hideFullPageSpinner()}}function ShowHideDiv(div,checked){if(checked){document.getElementById(div).style.display="block";if(g_PlotMonthPrecipitation)g_PlotMonthPrecipitation.resize();if(g_PlotIDFCurve)g_PlotIDFCurve.resize();if(g_plotAnnualMaximumPrecipitation)g_plotAnnualMaximumPrecipitation.resize();if(g_plotTopTenLargestPrecipitation)g_plotTopTenLargestPrecipitation.resize();if(g_plotTopTenLongestPrecipitation)g_plotTopTenLongestPrecipitation.resize();if(g_plotVolumetricHydrology)g_plotVolumetricHydrology.resize();if(g_plotTrendAnalysis)g_plotTrendAnalysis.resize();if(g_plotAnomaly)g_plotAnomaly.resize();if(g_plotexceedanceprobabilty)g_plotexceedanceprobabilty.resize();if(g_plotAnnualCycle)g_plotAnnualCycle.resize();if(g_plotSeasonalPCA)g_plotSeasonalPCA.resize();if(g_plotMonthlyBox)g_plotMonthlyBox.resize()}else{document.getElementById(div).style.display="none"}}function showAllCharts(bShow=true){removeAllHighCharts();if(bShow){document.getElementById("div_chart_hpcp_hourlydata").style.display="block";document.getElementById("div_chart_hpcp_ietd_sum").style.display="block";document.getElementById("div_chart_hpcp_ietd_avg").style.display="block";document.getElementById("div_charts01").style.display="block";document.getElementById("div_charts02").style.display="block";document.getElementById("div_charts03").style.display="block";document.getElementById("div_charts04").style.display="block";document.getElementById("dnietddata").style.display="block";document.getElementById("dnrawdata").style.display="block"}else{document.getElementById("div_chart_hpcp_hourlydata").style.display="none";document.getElementById("div_chart_hpcp_ietd_sum").style.display="none";document.getElementById("div_chart_hpcp_ietd_avg").style.display="none";document.getElementById("div_charts01").style.display="none";document.getElementById("div_charts02").style.display="none";document.getElementById("div_charts03").style.display="none";document.getElementById("div_charts04").style.display="none";document.getElementById("dnietddata").style.display="none";document.getElementById("dnrawdata").style.display="none";resetInputs()}}function resetInputs(){g_DataTable_HPCP_SUM.clear().draw();document.getElementById("latitude").value="";document.getElementById("longitude").value="";document.getElementById("elevation").value="";document.getElementById("avdatafrom").value="";document.getElementById("avdatato").value="";document.getElementById("beginningdate").value="";document.getElementById("endingdate").value="";document.getElementById("ietd").value="";document.getElementById("ietdtitle").innerHTML="IETD Analysis - Analyzing Independent Precipitation Events"}function validateForm(){if(document.getElementById("state").value==""){document.getElementById("state").focus();Swal.fire({title:"Oops...",text:"State needs to be selected!!",icon:"error"});return false}if(document.getElementById("station").value==""){document.getElementById("station").focus();Swal.fire({title:"Oops...",text:"Station needs to be selected!!",icon:"error"});return false}if(document.getElementById("beginningdate").value==""){document.getElementById("beginningdate").focus();Swal.fire({title:"Oops...",text:"From date needs to be entered!!",icon:"error"});return false}if(document.getElementById("endingdate").value==""){document.getElementById("endingdate").focus();Swal.fire({title:"Oops...",text:"To date needs to be entered!!",icon:"error"});return false}let BeginningDate=new Date(document.getElementById("beginningdate").value);let EndingDate=new Date(document.getElementById("endingdate").value);if(BeginningDate==EndingDate){document.getElementById("endingdate").focus();Swal.fire({title:"Oops...",text:"The beginning date and the ending date cannot be the same!!",icon:"error"});return false}if(BeginningDate>EndingDate){document.getElementById("endingdate").focus();Swal.fire({title:"Oops...",text:"The ending date must be after the beginning date!!",icon:"error"});return false}if(document.getElementById("ietd").value==""){document.getElementById("ietd").focus();Swal.fire({title:"Oops...",text:"IETD range value needs to be entered!!",icon:"error"});return false}if(Number.isInteger(Number(document.getElementById("ietd").value))==false||Number(document.getElementById("ietd").value)<1){document.getElementById("ietd").focus();Swal.fire({title:"Oops...",text:"IETD range value must be a positive integer value ( value >= 1 )!!",icon:"error"});return false}return true}function changeState(state){showAllCharts(false);let selectcomboBox=document.getElementById("station");while(selectcomboBox.options.length>0){selectcomboBox.remove(0)}if(state==""){return}if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200){let obj=JSON.parse(xmlhttp.responseText.trim());if(obj!=null){let option=document.createElement("option");option.value="";option.text="[Select Station]";selectcomboBox.add(option);for(let i=0;i<obj.length;i++){let option=document.createElement("option");option.value=obj[i].IDX;option.text=obj[i].NAME+" ("+obj[i].BEG_DT+"~"+obj[i].END_DT+")";selectcomboBox.add(option)}}else{Swal.fire({title:"Error Occurred!",text:"unexpected error occurred!!",icon:"warning"})}}};let param="state="+state;xmlhttp.open("GET","get_hourlydata_stationlist.php?"+param,true);xmlhttp.send()}function Getmoment(strDate){const datetime=strDate.split(" ");const date=datetime[0].split("-");date[1]=date[1]-1;let momentDate=moment([date[0],date[1],date[2],0,0,0,0]);return momentDate}function GetStationInfo(station){showAllCharts(false);if(window.XMLHttpRequest){xmlhttp=new XMLHttpRequest}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}xmlhttp.onreadystatechange=function(){if(xmlhttp.readyState==4&&xmlhttp.status==200){let obj=JSON.parse(xmlhttp.responseText.trim());if(obj!=null){olSetNewMapPosition(g_olMap,obj[0].Longitude,obj[0].Latitude);let mapHrefUrl="https://maps.google.com?q="+obj[0].Latitude+","+obj[0].Longitude+"";document.getElementById("map_location_href").href=mapHrefUrl;document.getElementById("latitude").value=obj[0].Latitude;document.getElementById("longitude").value=obj[0].Longitude;document.getElementById("elevation").value=obj[0].Elevation;document.getElementById("avdatafrom").value=obj[0].DataFrom;document.getElementById("avdatato").value=obj[0].DataTo;document.getElementById("beginningdate").value=obj[0].DataFrom;document.getElementById("endingdate").value=obj[0].DataTo;const DateFrom=Getmoment(obj[0].DataFrom);const DateTo=Getmoment(obj[0].DataTo);g_DatePicker_beginningdate.dates.setValue(tempusDominus.DateTime.convert(new Date(DateFrom)));g_DatePicker_beginningdate.updateOptions({restrictions:{minDate:new Date(DateFrom),maxDate:new Date(DateTo)}});g_DatePicker_endingdate.dates.setValue(tempusDominus.DateTime.convert(new Date(DateTo)));g_DatePicker_endingdate.updateOptions({restrictions:{minDate:new Date(DateFrom),maxDate:new Date(DateTo)}})}else{Swal.fire({title:"Error Occurred!",text:"unexpected error occurred!!",icon:"warning"})}}};xmlhttp.open("GET","get_hourlydata_stationinfo.php?station="+station,true);xmlhttp.send()}function timeConverter(UNIX_timestamp){const date=new Date(UNIX_timestamp).toISOString().substr(0,19).replace("T"," ");return date}function timeFormat(UNIX_timestamp){const date=new Date(UNIX_timestamp).toISOString().substr(0,19).replace("T"," ").replace(":00:00","h");return date}function timePeriod(UNIX_timestamp1,UNIX_timestamp2){const dateFrom=new Date(UNIX_timestamp1);const dateTo=new Date(UNIX_timestamp2);const month=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if(dateFrom.getUTCFullYear()!=dateTo.getUTCFullYear()){const from=dateFrom.getUTCFullYear()+"-"+month[dateFrom.getUTCMonth()]+"-"+dateFrom.getUTCDate().toString().padStart(2,"0")+" "+dateFrom.getUTCHours()+"h";const to=dateTo.getUTCFullYear()+"-"+month[dateTo.getUTCMonth()]+"-"+dateTo.getUTCDate().toString().padStart(2,"0")+" "+dateTo.getUTCHours()+"h";return from+" ~ "+to}if(dateFrom.getUTCFullYear()==dateTo.getUTCFullYear()&&dateFrom.getUTCMonth()!=dateTo.getUTCMonth()){const from=dateFrom.getUTCFullYear()+"-"+month[dateFrom.getUTCMonth()]+"-"+dateFrom.getUTCDate().toString().padStart(2,"0")+" "+dateFrom.getUTCHours()+"h";const to=month[dateTo.getUTCMonth()]+"-"+dateTo.getUTCDate().toString().padStart(2,"0")+" "+dateTo.getUTCHours()+"h";return from+" ~ "+to}if(dateFrom.getUTCFullYear()==dateTo.getUTCFullYear()&&dateFrom.getUTCMonth()==dateTo.getUTCMonth()&&dateFrom.getUTCDate()!=dateTo.getUTCDate()){const from=dateFrom.getUTCFullYear()+"-"+month[dateFrom.getUTCMonth()]+"-"+dateFrom.getUTCDate().toString().padStart(2,"0")+" "+dateFrom.getUTCHours()+"h";const to=month[dateTo.getUTCMonth()]+"-"+dateTo.getUTCDate().toString().padStart(2,"0")+" "+dateTo.getUTCHours()+"h";return from+" ~ "+to}const from=dateFrom.getUTCFullYear()+"-"+month[dateFrom.getUTCMonth()]+"-"+dateFrom.getUTCDate().toString().padStart(2,"0")+" "+dateFrom.getUTCHours()+"h";const to=dateTo.getUTCHours()+"h";return from+" ~ "+to}function IETDAnalysis(IETDhour,hourlydata){IETDhour_unixtimestamp=parseInt(IETDhour)*60*1e3;let Event=null;let IETDDATA=[];for(let i=0;i<hourlydata.length;i++){let Date_Begin=hourlydata[i][0];let Date_End=hourlydata[i][1];let HPD=hourlydata[i][2];if(Event==null){Event=[Date_Begin,Date_End,HPD,1]}else{if((Date_Begin-Event[1])/60<=IETDhour_unixtimestamp){Event[1]=Date_End;Event[2]+=HPD;Event[3]+=1}else{IETDDATA.push(Event);Event=[Date_Begin,Date_End,HPD,1]}}}if(Event!=null){IETDDATA.push(Event)}return IETDDATA}function roundToTwo(num){return+(Math.round(num+"e+2")+"e-2")}function buildHPCPSUMAVGCharts(IETDhour,ietd_data){let DataTable_dataSet=[];let chart_ietd_sum_data=[];let chart_ietd_avg_data=[];for(let i=0;i<ietd_data.length;i++){const datefrom=ietd_data[i][0];const dateto=ietd_data[i][1];let sum=ietd_data[i][2];const count=ietd_data[i][3];let avg=sum/count;sum=roundToTwo(sum);avg=roundToTwo(avg);DataTable_dataSet.push([timeConverter(datefrom),timeConverter(dateto),sum,count]);data_element=[];data_element.push(datefrom);data_element.push(0);chart_ietd_sum_data.push(data_element);chart_ietd_avg_data.push(data_element);data_element=[];data_element.push(datefrom);data_element.push(sum);chart_ietd_sum_data.push(data_element);data_element=[];data_element.push(datefrom);data_element.push(avg);chart_ietd_avg_data.push(data_element);data_element=[];data_element.push(dateto);data_element.push(sum);chart_ietd_sum_data.push(data_element);data_element=[];data_element.push(dateto);data_element.push(avg);chart_ietd_avg_data.push(data_element);data_element=[];data_element.push(dateto);data_element.push(0);chart_ietd_sum_data.push(data_element);chart_ietd_avg_data.push(data_element)}const IETDHour_text="IETD="+IETDhour+" "+(IETDhour>1?"hours":"hour");createChart("chart_hpcp_ietd_sum","Sum of Independent Precipitation Events ("+IETDHour_text+")","center","","HPD",chart_ietd_sum_data);createChart("chart_hpcp_ietd_avg","Avg of Independent Precipitation Events ("+IETDHour_text+")","center","","HPD",chart_ietd_avg_data);g_DataTable_HPCP_SUM.clear();g_DataTable_HPCP_SUM.rows.add(DataTable_dataSet).draw()}function buildHPCPOrgChart(rawHPCPData){let chart_rawHPCPData=[];for(let i=0;i<rawHPCPData.length;i++){const datefrom=rawHPCPData[i][0];const dateto=rawHPCPData[i][1];let hpcp=rawHPCPData[i][2];hpcp=roundToTwo(hpcp);data_element=[];data_element.push(datefrom);data_element.push(0);chart_rawHPCPData.push(data_element);data_element=[];data_element.push(datefrom);data_element.push(hpcp);chart_rawHPCPData.push(data_element);data_element=[];data_element.push(dateto);data_element.push(hpcp);chart_rawHPCPData.push(data_element);data_element=[];data_element.push(dateto);data_element.push(0);chart_rawHPCPData.push(data_element)}createChart("chart_hpcp_hourlydata","Original Hourly Precipitation Data (HPD)","center","","HPCP",chart_rawHPCPData)}function destroyAllCharts(){if(g_PlotMonthPrecipitation){g_PlotMonthPrecipitation.destroy();g_PlotMonthPrecipitation=null}if(g_PlotIDFCurve){g_PlotIDFCurve.destroy();g_PlotIDFCurve=null}if(g_plotTopTenLargestPrecipitation){g_plotTopTenLargestPrecipitation.destroy();g_plotTopTenLargestPrecipitation=null}if(g_plotTopTenLongestPrecipitation){g_plotTopTenLongestPrecipitation.destroy();g_plotTopTenLongestPrecipitation=null}if(g_plotVolumetricHydrology){g_plotVolumetricHydrology.destroy();g_plotVolumetricHydrology=null}if(g_plotTrendAnalysis){g_plotTrendAnalysis.destroy();g_plotTrendAnalysis=null}if(g_plotAnomaly){g_plotAnomaly.destroy();g_plotAnomaly=null}if(g_plotexceedanceprobabilty){g_plotexceedanceprobabilty.destroy();g_plotexceedanceprobabilty=null}if(g_plotAnnualCycle){g_plotAnnualCycle.destroy();g_plotAnnualCycle=null}if(g_plotSeasonalPCA){g_plotSeasonalPCA.destroy();g_plotSeasonalPCA=null}if(g_plotMonthlyBox){g_plotMonthlyBox.destroy();g_plotMonthlyBox=null}}function createAllCharts(IETDhour,rawHPCPData,IETDData){destroyAllCharts();buildHPCPOrgChart(rawHPCPData);buildHPCPSUMAVGCharts(IETDhour,IETDData);g_PlotIDFCurve=new IDFCurvePlot("chart_hpcp_idf_curve",rawHPCPData,IETDhour);g_PlotMonthPrecipitation=new MonthlyPrecipitationPlot("chart_hpcp_monthly",rawHPCPData,IETDData);g_plotAnnualMaximumPrecipitation=new AnnualMaximumPrecipitationPlot("chart_hpcp_annual_max_precipitation",IETDhour,IETDData);g_plotTopTenLargestPrecipitation=new TopTenLargestPrecipitationPlot("chart_hpcp_top_ten_largest_precipitation",IETDhour,IETDData);g_plotTopTenLongestPrecipitation=new TopTenLongestPrecipitationPlot("chart_hpcp_top_ten_longest_precipitation",IETDhour,IETDData);g_plotVolumetricHydrology=new VolumetricHydrologyPlot("chart_hpcp_volumetric_hydrology_precipitation",IETDhour,IETDData);g_plotTrendAnalysis=new TrendAnalysisPlot("chart_hpcp_trendanalysis",IETDhour,IETDData);g_plotAnomaly=new AnomalyPlot("chart_hpcp_anomalies",IETDhour,IETDData);g_plotexceedanceprobabilty=new ExceedanceProbabilityPlot("chart_hpcp_exceedanceprobability",IETDhour,IETDData);g_plotAnnualCycle=new AnnualCyclePlot("chart_hpcp_annualcylcle",IETDhour,IETDData);g_plotSeasonalPCA=new SeasonalPCAPlot("chart_hpcp_seasonalpac",IETDhour,IETDData);g_plotMonthlyBox=new MonthlyDistribution("chart_hpcp_monthlyboxplot",IETDhour,IETDData);document.getElementById("ietdtitle").innerHTML="IETD Analysis - Analyzing Independent Precipitation Events (<span style='color:red'>"+document.getElementById("ietd").value+" hour(s)</span>)"}function debounce(func,wait){let timeout;return function executedFunction(...args){const later=()=>{clearTimeout(timeout);func(...args)};clearTimeout(timeout);timeout=setTimeout(later,wait)}}async function Zoom_based_UpdateCharts(starttime,endtime){const IETDhour=document.getElementById("ietd").value;if(starttime!==undefined&&endtime!==undefined){let newIETDData=[];let newRawData=[];for(let i=0;i<g_AnalyzedIETDData.length;i++){const datefrom=g_AnalyzedIETDData[i][0];const dateto=g_AnalyzedIETDData[i][1];if(starttime<=datefrom&&dateto<=endtime){newIETDData.push(g_AnalyzedIETDData[i])}}for(let i=0;i<g_RawHPCPData.length;i++){const datefrom=g_RawHPCPData[i][0];const dateto=g_RawHPCPData[i][1];if(starttime<=datefrom&&dateto<=endtime){newRawData.push(g_RawHPCPData[i])}}if(g_PlotMonthPrecipitation)g_PlotMonthPrecipitation.updateData(newRawData,newIETDData);if(g_PlotIDFCurve)g_PlotIDFCurve.updateData(newRawData);if(g_plotAnnualMaximumPrecipitation)g_plotAnnualMaximumPrecipitation.updateData(newIETDData,IETDhour);if(g_plotTopTenLargestPrecipitation)g_plotTopTenLargestPrecipitation.updateData(newIETDData,IETDhour);if(g_plotTopTenLongestPrecipitation)g_plotTopTenLongestPrecipitation.updateData(newIETDData,IETDhour);if(g_plotVolumetricHydrology)g_plotVolumetricHydrology.updateData(newIETDData,IETDhour);if(g_plotTrendAnalysis)g_plotTrendAnalysis.updateData(newIETDData,IETDhour);if(g_plotAnomaly)g_plotAnomaly.updateData(newIETDData,IETDhour);if(g_plotexceedanceprobabilty)g_plotexceedanceprobabilty.updateData(newIETDData,IETDhour);if(g_plotAnnualCycle)g_plotAnnualCycle.updateData(newIETDData,IETDhour);if(g_plotSeasonalPCA)g_plotSeasonalPCA.updateData(newIETDData,IETDhour);if(g_plotMonthlyBox)g_plotMonthlyBox.updateData(newIETDData,IETDhour)}}function UncertaintyComputation(IETDdata){let a_x=baseRate;let alpha,beta;for(let hr=0;hr<24;hr++){const r_x=SL24hours[hr].abnormal;const s_x=SL24hours[hr].normal;alpha=r_x+a_x*W;beta=s_x+(1-a_x)*W;SL24hours[hr].belief=r_x/(r_x+s_x+W);SL24hours[hr].disbelief=s_x/(r_x+s_x+W);SL24hours[hr].uncertainty=W/(r_x+s_x+W);SL24hours[hr].projected_probability=SL24hours[hr].belief+a_x*SL24hours[hr].uncertainty;a_x=alpha/(alpha+beta)}}function analyzeHPCPAnalyzeData(rawHPCPData){const IETDhour=document.getElementById("ietd").value;g_RawHPCPData=rawHPCPData;g_AnalyzedIETDData=IETDAnalysis(IETDhour,rawHPCPData);createAllCharts(IETDhour,rawHPCPData,g_AnalyzedIETDData);const IETDHour_text="IETD="+IETDhour+" "+(IETDhour>1?"hours":"hour");document.getElementById("ietdtitle").innerHTML="IETD Analysis - Analyzing Independent Precipitation Events (<span style='color:red'>"+IETDHour_text+"</span>)"}$(document).ready(function(){document.addEventListener("keydown",event=>{if(event.key==="Control"){g_ZoomingEnabled=true}});document.addEventListener("keyup",event=>{if(g_ZoomingEnabled===true&&g_PreviousTimeRangeWhenZoomingActivated.length>0){HichartZooming(g_PreviousTimeRangeWhenZoomingActivated[0],g_PreviousTimeRangeWhenZoomingActivated[1]);redrawHighlights_in_allHighcharts();g_PreviousTimeRangeWhenZoomingActivated=[];g_ZoomingEnabled=false}});g_DatePicker_beginningdate=new tempusDominus.TempusDominus(document.getElementById("beginningdate"),{display:{components:{clock:false}},localization:{format:"yyyy-MM-dd"}});g_DatePicker_endingdate=new tempusDominus.TempusDominus(document.getElementById("endingdate"),{display:{components:{clock:false}},localization:{format:"yyyy-MM-dd"}});$("#beginningdate").on("change",function(e){if(document.getElementById("state").value===""){document.getElementById("beginningdate").value="";document.getElementById("endingdate").value="";document.getElementById("state").focus();Swal.fire({title:"Oops...",text:"State needs to be selected first!!",icon:"error"});return false}if(document.getElementById("station").value===""){document.getElementById("beginningdate").value="";document.getElementById("endingdate").value="";document.getElementById("station").focus();Swal.fire({title:"Oops...",text:"Station needs to be selected first!!",icon:"error"});return false}g_DatePicker_endingdate.updateOptions({restrictions:{minDate:new Date($(this).val())}})});$("#endingdate").on("dp.change",function(e){if(document.getElementById("state").value===""){document.getElementById("beginningdate").value="";document.getElementById("endingdate").value="";document.getElementById("state").focus();Swal.fire({title:"Oops...",text:"State needs to be selected first!!",icon:"error"});return false}if(document.getElementById("station").value===""){document.getElementById("beginningdate").value="";document.getElementById("endingdate").value="";document.getElementById("station").focus();Swal.fire({title:"Oops...",text:"Station needs to be selected first!!",icon:"error"});return false}g_DatePicker_beginningdate.updateOptions({restrictions:{maxDate:new Date($(this).val())}})});g_DataTable_HPCP_SUM=$("#precipitationdata_sum").DataTable({dom:"Bfrtip",iDisplayLength:5,lengthChange:false,buttons:["csv"],fnInitComplete:function(oSettings,json){const btnClear=$('<button class="btnClearDataTableFilter" style="height:26px;">CLEAR</button>');btnClear.appendTo($("#"+oSettings.sTableId).parents(".dataTables_wrapper").find(".dataTables_filter"));$("#"+oSettings.sTableId+"_wrapper .btnClearDataTableFilter").click(function(){$("#"+oSettings.sTableId).dataTable().fnFilter("")})}})});