(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory(require("highcharts"));else if(typeof define==="function"&&define.amd)define("highcharts/modules/data-tools",[["highcharts/highcharts"]],factory);else if(typeof exports==="object")exports["highcharts/modules/data-tools"]=factory(require("highcharts"));else root["Highcharts"]=factory(root["Highcharts"])})(this,function(__WEBPACK_EXTERNAL_MODULE__944__){return function(){"use strict";var __webpack_modules__={944:function(module){module.exports=__WEBPACK_EXTERNAL_MODULE__944__}};var __webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==undefined){return cachedModule.exports}var module=__webpack_module_cache__[moduleId]={exports:{}};__webpack_modules__[moduleId](module,module.exports,__webpack_require__);return module.exports}!function(){__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module["default"]}:function(){return module};__webpack_require__.d(getter,{a:getter});return getter}}();!function(){__webpack_require__.d=function(exports,definition){for(var key in definition){if(__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)){Object.defineProperty(exports,key,{enumerable:true,get:definition[key]})}}}}();!function(){__webpack_require__.o=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}}();var __webpack_exports__={};__webpack_require__.d(__webpack_exports__,{default:function(){return data_tools_src}});var highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_=__webpack_require__(944);var highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default=__webpack_require__.n(highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_);var addEvent=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().addEvent,fireEvent=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().fireEvent,merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge;var DataModifier=function(){function DataModifier(){}DataModifier.prototype.benchmark=function(dataTable,options){var results=[];var modifier=this;var execute=function(){modifier.modifyTable(dataTable);modifier.emit({type:"afterBenchmarkIteration"})};var defaultOptions={iterations:1};var iterations=merge(defaultOptions,options).iterations;modifier.on("afterBenchmarkIteration",function(){if(results.length===iterations){modifier.emit({type:"afterBenchmark",results:results});return}execute()});var times={startTime:0,endTime:0};modifier.on("modify",function(){times.startTime=window.performance.now()});modifier.on("afterModify",function(){times.endTime=window.performance.now();results.push(times.endTime-times.startTime)});execute();return results};DataModifier.prototype.emit=function(e){fireEvent(this,e.type,e)};DataModifier.prototype.modify=function(table,eventDetail){var modifier=this;return new Promise(function(resolve,reject){if(table.modified===table){table.modified=table.clone(false,eventDetail)}try{resolve(modifier.modifyTable(table,eventDetail))}catch(e){modifier.emit({type:"error",detail:eventDetail,table:table});reject(e)}})};DataModifier.prototype.modifyCell=function(table,columnName,rowIndex,cellValue,eventDetail){return this.modifyTable(table)};DataModifier.prototype.modifyColumns=function(table,columns,rowIndex,eventDetail){return this.modifyTable(table)};DataModifier.prototype.modifyRows=function(table,rows,rowIndex,eventDetail){return this.modifyTable(table)};DataModifier.prototype.on=function(type,callback){return addEvent(this,type,callback)};return DataModifier}();(function(DataModifier){DataModifier.types={};function registerType(key,DataModifierClass){return!!key&&!DataModifier.types[key]&&!!(DataModifier.types[key]=DataModifierClass)}DataModifier.registerType=registerType})(DataModifier||(DataModifier={}));var Modifiers_DataModifier=DataModifier;var DataTableCore_fireEvent=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().fireEvent,isArray=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().isArray,objectEach=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().objectEach,uniqueKey=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().uniqueKey;var DataTableCore=function(){function DataTableCore(options){if(options===void 0){options={}}var _this=this;this.autoId=!options.id;this.columns={};this.id=options.id||uniqueKey();this.modified=this;this.rowCount=0;this.versionTag=uniqueKey();var rowCount=0;objectEach(options.columns||{},function(column,columnName){_this.columns[columnName]=column.slice();rowCount=Math.max(rowCount,column.length)});this.applyRowCount(rowCount)}DataTableCore.prototype.applyRowCount=function(rowCount){this.rowCount=rowCount;objectEach(this.columns,function(column){if(isArray(column)){column.length=rowCount}})};DataTableCore.prototype.getColumn=function(columnName,asReference){return this.columns[columnName]};DataTableCore.prototype.getColumns=function(columnNames,asReference){var _this=this;return(columnNames||Object.keys(this.columns)).reduce(function(columns,columnName){columns[columnName]=_this.columns[columnName];return columns},{})};DataTableCore.prototype.getRow=function(rowIndex,columnNames){var _this=this;return(columnNames||Object.keys(this.columns)).map(function(key){var _a;return(_a=_this.columns[key])===null||_a===void 0?void 0:_a[rowIndex]})};DataTableCore.prototype.setColumn=function(columnName,column,rowIndex,eventDetail){var _a;if(column===void 0){column=[]}if(rowIndex===void 0){rowIndex=0}this.setColumns((_a={},_a[columnName]=column,_a),rowIndex,eventDetail)};DataTableCore.prototype.setColumns=function(columns,rowIndex,eventDetail){var _this=this;var rowCount=this.rowCount;objectEach(columns,function(column,columnName){_this.columns[columnName]=column.slice();rowCount=column.length});this.applyRowCount(rowCount);if(!(eventDetail===null||eventDetail===void 0?void 0:eventDetail.silent)){DataTableCore_fireEvent(this,"afterSetColumns");this.versionTag=uniqueKey()}};DataTableCore.prototype.setRow=function(row,rowIndex,insert,eventDetail){if(rowIndex===void 0){rowIndex=this.rowCount}var columns=this.columns,indexRowCount=insert?this.rowCount+1:rowIndex+1;objectEach(row,function(cellValue,columnName){var column=columns[columnName]||(eventDetail===null||eventDetail===void 0?void 0:eventDetail.addColumns)!==false&&new Array(indexRowCount);if(column){if(insert){column.splice(rowIndex,0,cellValue)}else{column[rowIndex]=cellValue}columns[columnName]=column}});if(indexRowCount>this.rowCount){this.applyRowCount(indexRowCount)}if(!(eventDetail===null||eventDetail===void 0?void 0:eventDetail.silent)){DataTableCore_fireEvent(this,"afterSetRows");this.versionTag=uniqueKey()}};return DataTableCore}();var Data_DataTableCore=DataTableCore;"";var __extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var DataTable_addEvent=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().addEvent,defined=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().defined,DataTable_fireEvent=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().fireEvent,extend=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().extend,DataTable_uniqueKey=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().uniqueKey;var DataTable=function(_super){__extends(DataTable,_super);function DataTable(options){if(options===void 0){options={}}var _this=_super.call(this,options)||this;_this.modified=_this;return _this}DataTable.isNull=function(row){if(row===DataTable.NULL){return true}if(row instanceof Array){if(!row.length){return false}for(var i=0,iEnd=row.length;i<iEnd;++i){if(row[i]!==null){return false}}}else{var columnNames=Object.keys(row);if(!columnNames.length){return false}for(var i=0,iEnd=columnNames.length;i<iEnd;++i){if(row[columnNames[i]]!==null){return false}}}return true};DataTable.prototype.clone=function(skipColumns,eventDetail){var table=this,tableOptions={};table.emit({type:"cloneTable",detail:eventDetail});if(!skipColumns){tableOptions.columns=table.columns}if(!table.autoId){tableOptions.id=table.id}var tableClone=new DataTable(tableOptions);if(!skipColumns){tableClone.versionTag=table.versionTag;tableClone.originalRowIndexes=table.originalRowIndexes;tableClone.localRowIndexes=table.localRowIndexes}table.emit({type:"afterCloneTable",detail:eventDetail,tableClone:tableClone});return tableClone};DataTable.prototype.deleteColumns=function(columnNames,eventDetail){var table=this,columns=table.columns,deletedColumns={},modifiedColumns={},modifier=table.modifier,rowCount=table.rowCount;columnNames=columnNames||Object.keys(columns);if(columnNames.length){table.emit({type:"deleteColumns",columnNames:columnNames,detail:eventDetail});for(var i=0,iEnd=columnNames.length,column=void 0,columnName=void 0;i<iEnd;++i){columnName=columnNames[i];column=columns[columnName];if(column){deletedColumns[columnName]=column;modifiedColumns[columnName]=new Array(rowCount)}delete columns[columnName]}if(!Object.keys(columns).length){table.rowCount=0;this.deleteRowIndexReferences()}if(modifier){modifier.modifyColumns(table,modifiedColumns,0,eventDetail)}table.emit({type:"afterDeleteColumns",columns:deletedColumns,columnNames:columnNames,detail:eventDetail});return deletedColumns}};DataTable.prototype.deleteRowIndexReferences=function(){delete this.originalRowIndexes;delete this.localRowIndexes};DataTable.prototype.deleteRows=function(rowIndex,rowCount,eventDetail){if(rowCount===void 0){rowCount=1}var table=this,deletedRows=[],modifiedRows=[],modifier=table.modifier;table.emit({type:"deleteRows",detail:eventDetail,rowCount:rowCount,rowIndex:rowIndex||0});if(typeof rowIndex==="undefined"){rowIndex=0;rowCount=table.rowCount}if(rowCount>0&&rowIndex<table.rowCount){var columns=table.columns,columnNames=Object.keys(columns);for(var i=0,iEnd=columnNames.length,column=void 0,deletedCells=void 0;i<iEnd;++i){column=columns[columnNames[i]];deletedCells=column.splice(rowIndex,rowCount);if(!i){table.rowCount=column.length}for(var j=0,jEnd=deletedCells.length;j<jEnd;++j){deletedRows[j]=deletedRows[j]||[];deletedRows[j][i]=deletedCells[j]}modifiedRows.push(new Array(iEnd))}}if(modifier){modifier.modifyRows(table,modifiedRows,rowIndex||0,eventDetail)}table.emit({type:"afterDeleteRows",detail:eventDetail,rowCount:rowCount,rowIndex:rowIndex||0,rows:deletedRows});return deletedRows};DataTable.prototype.emit=function(e){if(["afterDeleteColumns","afterDeleteRows","afterSetCell","afterSetColumns","afterSetRows"].includes(e.type)){this.versionTag=DataTable_uniqueKey()}DataTable_fireEvent(this,e.type,e)};DataTable.prototype.getCell=function(columnName,rowIndex){var table=this;var column=table.columns[columnName];if(column){return column[rowIndex]}};DataTable.prototype.getCellAsBoolean=function(columnName,rowIndex){var table=this;var column=table.columns[columnName];return!!(column&&column[rowIndex])};DataTable.prototype.getCellAsNumber=function(columnName,rowIndex,useNaN){var table=this;var column=table.columns[columnName];var cellValue=column&&column[rowIndex];switch(typeof cellValue){case"boolean":return cellValue?1:0;case"number":return isNaN(cellValue)&&!useNaN?null:cellValue}cellValue=parseFloat("".concat(cellValue!==null&&cellValue!==void 0?cellValue:""));return isNaN(cellValue)&&!useNaN?null:cellValue};DataTable.prototype.getCellAsString=function(columnName,rowIndex){var table=this;var column=table.columns[columnName];return"".concat(column&&column[rowIndex])};DataTable.prototype.getColumn=function(columnName,asReference){return this.getColumns([columnName],asReference)[columnName]};DataTable.prototype.getColumnAsNumbers=function(columnName,useNaN){var table=this,columns=table.columns;var column=columns[columnName],columnAsNumber=[];if(column){var columnLength=column.length;if(useNaN){for(var i=0;i<columnLength;++i){columnAsNumber.push(table.getCellAsNumber(columnName,i,true))}}else{for(var i=0,cellValue=void 0;i<columnLength;++i){cellValue=column[i];if(typeof cellValue==="number"){return column.slice()}if(cellValue!==null&&typeof cellValue!=="undefined"){break}}for(var i=0;i<columnLength;++i){columnAsNumber.push(table.getCellAsNumber(columnName,i))}}}return columnAsNumber};DataTable.prototype.getColumnNames=function(){var table=this,columnNames=Object.keys(table.columns);return columnNames};DataTable.prototype.getColumns=function(columnNames,asReference){var table=this,tableColumns=table.columns,columns={};columnNames=columnNames||Object.keys(tableColumns);for(var i=0,iEnd=columnNames.length,column=void 0,columnName=void 0;i<iEnd;++i){columnName=columnNames[i];column=tableColumns[columnName];if(column){columns[columnName]=asReference?column:column.slice()}}return columns};DataTable.prototype.getLocalRowIndex=function(originalRowIndex){var localRowIndexes=this.localRowIndexes;if(localRowIndexes){return localRowIndexes[originalRowIndex]}return originalRowIndex};DataTable.prototype.getModifier=function(){return this.modifier};DataTable.prototype.getOriginalRowIndex=function(rowIndex){var originalRowIndexes=this.originalRowIndexes;if(originalRowIndexes){return originalRowIndexes[rowIndex]}return rowIndex};DataTable.prototype.getRow=function(rowIndex,columnNames){return this.getRows(rowIndex,1,columnNames)[0]};DataTable.prototype.getRowCount=function(){return this.rowCount};DataTable.prototype.getRowIndexBy=function(columnName,cellValue,rowIndexOffset){var table=this;var column=table.columns[columnName];if(column){var rowIndex=column.indexOf(cellValue,rowIndexOffset);if(rowIndex!==-1){return rowIndex}}};DataTable.prototype.getRowObject=function(rowIndex,columnNames){return this.getRowObjects(rowIndex,1,columnNames)[0]};DataTable.prototype.getRowObjects=function(rowIndex,rowCount,columnNames){if(rowIndex===void 0){rowIndex=0}if(rowCount===void 0){rowCount=this.rowCount-rowIndex}var table=this,columns=table.columns,rows=new Array(rowCount);columnNames=columnNames||Object.keys(columns);for(var i=rowIndex,i2=0,iEnd=Math.min(table.rowCount,rowIndex+rowCount),column=void 0,row=void 0;i<iEnd;++i,++i2){row=rows[i2]={};for(var _i=0,columnNames_1=columnNames;_i<columnNames_1.length;_i++){var columnName=columnNames_1[_i];column=columns[columnName];row[columnName]=column?column[i]:void 0}}return rows};DataTable.prototype.getRows=function(rowIndex,rowCount,columnNames){if(rowIndex===void 0){rowIndex=0}if(rowCount===void 0){rowCount=this.rowCount-rowIndex}var table=this,columns=table.columns,rows=new Array(rowCount);columnNames=columnNames||Object.keys(columns);for(var i=rowIndex,i2=0,iEnd=Math.min(table.rowCount,rowIndex+rowCount),column=void 0,row=void 0;i<iEnd;++i,++i2){row=rows[i2]=[];for(var _i=0,columnNames_2=columnNames;_i<columnNames_2.length;_i++){var columnName=columnNames_2[_i];column=columns[columnName];row.push(column?column[i]:void 0)}}return rows};DataTable.prototype.getVersionTag=function(){return this.versionTag};DataTable.prototype.hasColumns=function(columnNames){var table=this,columns=table.columns;for(var i=0,iEnd=columnNames.length,columnName=void 0;i<iEnd;++i){columnName=columnNames[i];if(!columns[columnName]){return false}}return true};DataTable.prototype.hasRowWith=function(columnName,cellValue){var table=this;var column=table.columns[columnName];if(column){return column.indexOf(cellValue)!==-1}return false};DataTable.prototype.on=function(type,callback){return DataTable_addEvent(this,type,callback)};DataTable.prototype.renameColumn=function(columnName,newColumnName){var table=this,columns=table.columns;if(columns[columnName]){if(columnName!==newColumnName){columns[newColumnName]=columns[columnName];delete columns[columnName]}return true}return false};DataTable.prototype.setCell=function(columnName,rowIndex,cellValue,eventDetail){var table=this,columns=table.columns,modifier=table.modifier;var column=columns[columnName];if(column&&column[rowIndex]===cellValue){return}table.emit({type:"setCell",cellValue:cellValue,columnName:columnName,detail:eventDetail,rowIndex:rowIndex});if(!column){column=columns[columnName]=new Array(table.rowCount)}if(rowIndex>=table.rowCount){table.rowCount=rowIndex+1}column[rowIndex]=cellValue;if(modifier){modifier.modifyCell(table,columnName,rowIndex,cellValue)}table.emit({type:"afterSetCell",cellValue:cellValue,columnName:columnName,detail:eventDetail,rowIndex:rowIndex})};DataTable.prototype.setColumns=function(columns,rowIndex,eventDetail){var table=this,tableColumns=table.columns,tableModifier=table.modifier,columnNames=Object.keys(columns);var rowCount=table.rowCount;table.emit({type:"setColumns",columns:columns,columnNames:columnNames,detail:eventDetail,rowIndex:rowIndex});if(typeof rowIndex==="undefined"){_super.prototype.setColumns.call(this,columns,rowIndex,extend(eventDetail,{silent:true}))}else{for(var i=0,iEnd=columnNames.length,column=void 0,columnName=void 0;i<iEnd;++i){columnName=columnNames[i];column=columns[columnName];var tableColumn=tableColumns[columnName]?tableColumns[columnName]:tableColumns[columnName]=new Array(table.rowCount);for(var i_1=rowIndex||0,iEnd_1=column.length;i_1<iEnd_1;++i_1){tableColumn[i_1]=column[i_1]}rowCount=Math.max(rowCount,tableColumn.length)}this.applyRowCount(rowCount)}if(tableModifier){tableModifier.modifyColumns(table,columns,rowIndex||0)}table.emit({type:"afterSetColumns",columns:columns,columnNames:columnNames,detail:eventDetail,rowIndex:rowIndex})};DataTable.prototype.setModifier=function(modifier,eventDetail){var table=this;var promise;table.emit({type:"setModifier",detail:eventDetail,modifier:modifier,modified:table.modified});table.modified=table;table.modifier=modifier;if(modifier){promise=modifier.modify(table)}else{promise=Promise.resolve(table)}return promise.then(function(table){table.emit({type:"afterSetModifier",detail:eventDetail,modifier:modifier,modified:table.modified});return table})["catch"](function(error){table.emit({type:"setModifierError",error:error,modifier:modifier,modified:table.modified});throw error})};DataTable.prototype.setOriginalRowIndexes=function(originalRowIndexes,omitLocalRowIndexes){if(omitLocalRowIndexes===void 0){omitLocalRowIndexes=false}this.originalRowIndexes=originalRowIndexes;if(omitLocalRowIndexes){return}var modifiedIndexes=this.localRowIndexes=[];for(var i=0,iEnd=originalRowIndexes.length,originalIndex=void 0;i<iEnd;++i){originalIndex=originalRowIndexes[i];if(defined(originalIndex)){modifiedIndexes[originalIndex]=i}}};DataTable.prototype.setRow=function(row,rowIndex,insert,eventDetail){this.setRows([row],rowIndex,insert,eventDetail)};DataTable.prototype.setRows=function(rows,rowIndex,insert,eventDetail){if(rowIndex===void 0){rowIndex=this.rowCount}var table=this,columns=table.columns,columnNames=Object.keys(columns),modifier=table.modifier,rowCount=rows.length;table.emit({type:"setRows",detail:eventDetail,rowCount:rowCount,rowIndex:rowIndex,rows:rows});for(var i=0,i2=rowIndex,row=void 0;i<rowCount;++i,++i2){row=rows[i];if(row===DataTable.NULL){for(var j=0,jEnd=columnNames.length;j<jEnd;++j){if(insert){columns[columnNames[j]].splice(i2,0,null)}else{columns[columnNames[j]][i2]=null}}}else if(row instanceof Array){for(var j=0,jEnd=columnNames.length;j<jEnd;++j){columns[columnNames[j]][i2]=row[j]}}else{_super.prototype.setRow.call(this,row,i2,void 0,{silent:true})}}var indexRowCount=insert?rowCount+rows.length:rowIndex+rowCount;if(indexRowCount>table.rowCount){table.rowCount=indexRowCount;for(var i=0,iEnd=columnNames.length;i<iEnd;++i){columns[columnNames[i]].length=indexRowCount}}if(modifier){modifier.modifyRows(table,rows,rowIndex)}table.emit({type:"afterSetRows",detail:eventDetail,rowCount:rowCount,rowIndex:rowIndex,rows:rows})};DataTable.NULL={};DataTable.version="1.0.0";return DataTable}(Data_DataTableCore);var Data_DataTable=DataTable;var DataConnector_addEvent=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().addEvent,DataConnector_fireEvent=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().fireEvent,DataConnector_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge,pick=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().pick;var DataConnector=function(){function DataConnector(options){if(options===void 0){options={}}this.table=new Data_DataTable(options.dataTable);this.metadata=options.metadata||{columns:{}}}Object.defineProperty(DataConnector.prototype,"polling",{get:function(){return!!this.polling},enumerable:false,configurable:true});DataConnector.prototype.describeColumn=function(name,columnMeta){var connector=this,columns=connector.metadata.columns;columns[name]=DataConnector_merge(columns[name]||{},columnMeta)};DataConnector.prototype.describeColumns=function(columns){var connector=this,columnNames=Object.keys(columns);var columnName;while(typeof(columnName=columnNames.pop())==="string"){connector.describeColumn(columnName,columns[columnName])}};DataConnector.prototype.emit=function(e){DataConnector_fireEvent(this,e.type,e)};DataConnector.prototype.getColumnOrder=function(usePresentationState){var connector=this,columns=connector.metadata.columns,names=Object.keys(columns||{});if(names.length){return names.sort(function(a,b){return pick(columns[a].index,0)-pick(columns[b].index,0)})}};DataConnector.prototype.getSortedColumns=function(usePresentationOrder){return this.table.getColumns(this.getColumnOrder(usePresentationOrder))};DataConnector.prototype.load=function(){DataConnector_fireEvent(this,"afterLoad",{table:this.table});return Promise.resolve(this)};DataConnector.prototype.on=function(type,callback){return DataConnector_addEvent(this,type,callback)};DataConnector.prototype.save=function(){DataConnector_fireEvent(this,"saveError",{table:this.table});return Promise.reject(new Error("Not implemented"))};DataConnector.prototype.setColumnOrder=function(columnNames){var connector=this;for(var i=0,iEnd=columnNames.length;i<iEnd;++i){connector.describeColumn(columnNames[i],{index:i})}};DataConnector.prototype.setModifierOptions=function(modifierOptions){var _this=this;var ModifierClass=modifierOptions&&Modifiers_DataModifier.types[modifierOptions.type];return this.table.setModifier(ModifierClass?new ModifierClass(modifierOptions):void 0).then(function(){return _this})};DataConnector.prototype.startPolling=function(refreshTime){if(refreshTime===void 0){refreshTime=1e3}var connector=this;window.clearTimeout(connector._polling);connector._polling=window.setTimeout(function(){return connector.load()["catch"](function(error){return connector.emit({type:"loadError",error:error,table:connector.table})}).then(function(){if(connector._polling){connector.startPolling(refreshTime)}})},refreshTime)};DataConnector.prototype.stopPolling=function(){var connector=this;window.clearTimeout(connector._polling);delete connector._polling};DataConnector.prototype.whatIs=function(name){return this.metadata.columns[name]};return DataConnector}();(function(DataConnector){DataConnector.types={};function registerType(key,DataConnectorClass){return!!key&&!DataConnector.types[key]&&!!(DataConnector.types[key]=DataConnectorClass)}DataConnector.registerType=registerType})(DataConnector||(DataConnector={}));var Connectors_DataConnector=DataConnector;var DataConverter_addEvent=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().addEvent,DataConverter_fireEvent=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().fireEvent,isNumber=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().isNumber,DataConverter_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge;var DataConverter=function(){function DataConverter(options){this.dateFormats={"YYYY/mm/dd":{regex:/^(\d{4})([\-\.\/])(\d{1,2})\2(\d{1,2})$/,parser:function(match){return match?Date.UTC(+match[1],match[3]-1,+match[4]):NaN}},"dd/mm/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(match){return match?Date.UTC(+match[4],match[3]-1,+match[1]):NaN},alternative:"mm/dd/YYYY"},"mm/dd/YYYY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{4})$/,parser:function(match){return match?Date.UTC(+match[4],match[1]-1,+match[3]):NaN}},"dd/mm/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(match){var d=new Date;if(!match){return NaN}var year=+match[4];if(year>d.getFullYear()-2e3){year+=1900}else{year+=2e3}return Date.UTC(year,match[3]-1,+match[1])},alternative:"mm/dd/YY"},"mm/dd/YY":{regex:/^(\d{1,2})([\-\.\/])(\d{1,2})\2(\d{2})$/,parser:function(match){return match?Date.UTC(+match[4]+2e3,match[1]-1,+match[3]):NaN}}};var mergedOptions=DataConverter_merge(DataConverter.defaultOptions,options);var regExpPoint=mergedOptions.decimalPoint;if(regExpPoint==="."||regExpPoint===","){regExpPoint=regExpPoint==="."?"\\.":",";this.decimalRegExp=new RegExp("^(-?[0-9]+)"+regExpPoint+"([0-9]+)$")}this.options=mergedOptions}DataConverter.prototype.asBoolean=function(value){if(typeof value==="boolean"){return value}if(typeof value==="string"){return value!==""&&value!=="0"&&value!=="false"}return!!this.asNumber(value)};DataConverter.prototype.asDate=function(value){var timestamp;if(typeof value==="string"){timestamp=this.parseDate(value)}else if(typeof value==="number"){timestamp=value}else if(value instanceof Date){return value}else{timestamp=this.parseDate(this.asString(value))}return new Date(timestamp)};DataConverter.prototype.asGuessedType=function(value){var converter=this,typeMap={number:converter.asNumber,Date:converter.asDate,string:converter.asString};return typeMap[converter.guessType(value)].call(converter,value)};DataConverter.prototype.asNumber=function(value){if(typeof value==="number"){return value}if(typeof value==="boolean"){return value?1:0}if(typeof value==="string"){var decimalRegex=this.decimalRegExp;if(value.indexOf(" ")>-1){value=value.replace(/\s+/g,"")}if(decimalRegex){if(!decimalRegex.test(value)){return NaN}value=value.replace(decimalRegex,"$1.$2")}return parseFloat(value)}if(value instanceof Date){return value.getDate()}if(value){return value.getRowCount()}return NaN};DataConverter.prototype.asString=function(value){return""+value};DataConverter.prototype.deduceDateFormat=function(data,limit,save){var parser=this,stable=[],max=[];var format="YYYY/mm/dd",thing,guessedFormat=[],i=0,madeDeduction=false,elem,j;if(!limit||limit>data.length){limit=data.length}for(;i<limit;i++){if(typeof data[i]!=="undefined"&&data[i]&&data[i].length){thing=data[i].trim().replace(/[\-\.\/]/g," ").split(" ");guessedFormat=["","",""];for(j=0;j<thing.length;j++){if(j<guessedFormat.length){elem=parseInt(thing[j],10);if(elem){max[j]=!max[j]||max[j]<elem?elem:max[j];if(typeof stable[j]!=="undefined"){if(stable[j]!==elem){stable[j]=false}}else{stable[j]=elem}if(elem>31){if(elem<100){guessedFormat[j]="YY"}else{guessedFormat[j]="YYYY"}}else if(elem>12&&elem<=31){guessedFormat[j]="dd";madeDeduction=true}else if(!guessedFormat[j].length){guessedFormat[j]="mm"}}}}}}if(madeDeduction){for(j=0;j<stable.length;j++){if(stable[j]!==false){if(max[j]>12&&guessedFormat[j]!=="YY"&&guessedFormat[j]!=="YYYY"){guessedFormat[j]="YY"}}else if(max[j]>12&&guessedFormat[j]==="mm"){guessedFormat[j]="dd"}}if(guessedFormat.length===3&&guessedFormat[1]==="dd"&&guessedFormat[2]==="dd"){guessedFormat[2]="YY"}format=guessedFormat.join("/")}if(save){parser.options.dateFormat=format}return format};DataConverter.prototype.emit=function(e){DataConverter_fireEvent(this,e.type,e)};DataConverter.prototype.export=function(connector,options){this.emit({type:"exportError",columns:[],headers:[]});throw new Error("Not implemented")};DataConverter.prototype.getTable=function(){throw new Error("Not implemented")};DataConverter.prototype.guessType=function(value){var converter=this;var result="string";if(typeof value==="string"){var trimedValue=converter.trim("".concat(value)),decimalRegExp=converter.decimalRegExp;var innerTrimedValue=converter.trim(trimedValue,true);if(decimalRegExp){innerTrimedValue=decimalRegExp.test(innerTrimedValue)?innerTrimedValue.replace(decimalRegExp,"$1.$2"):""}var floatValue=parseFloat(innerTrimedValue);if(+innerTrimedValue===floatValue){value=floatValue}else{var dateValue=converter.parseDate(value);result=isNumber(dateValue)?"Date":"string"}}if(typeof value==="number"){result=value>365*24*3600*1e3?"Date":"number"}return result};DataConverter.prototype.on=function(type,callback){return DataConverter_addEvent(this,type,callback)};DataConverter.prototype.parse=function(options){this.emit({type:"parseError",columns:[],headers:[]});throw new Error("Not implemented")};DataConverter.prototype.parseDate=function(value,dateFormatProp){var converter=this,options=converter.options;var dateFormat=dateFormatProp||options.dateFormat,result=NaN,key,format,match;if(options.parseDate){result=options.parseDate(value)}else{if(!dateFormat){for(key in converter.dateFormats){format=converter.dateFormats[key];match=value.match(format.regex);if(match){dateFormat=key;result=format.parser(match);break}}}else{format=converter.dateFormats[dateFormat];if(!format){format=converter.dateFormats["YYYY/mm/dd"]}match=value.match(format.regex);if(match){result=format.parser(match)}}if(!match){match=Date.parse(value);if(typeof match==="object"&&match!==null&&match.getTime){result=match.getTime()-match.getTimezoneOffset()*6e4}else if(isNumber(match)){result=match-new Date(match).getTimezoneOffset()*6e4;if(value.indexOf("2001")===-1&&new Date(result).getFullYear()===2001){result=NaN}}}}return result};DataConverter.prototype.trim=function(str,inside){if(typeof str==="string"){str=str.replace(/^\s+|\s+$/g,"");if(inside&&/^[\d\s]+$/.test(str)){str=str.replace(/\s/g,"")}}return str};DataConverter.defaultOptions={dateFormat:"",alternativeFormat:"",startColumn:0,endColumn:Number.MAX_VALUE,startRow:0,endRow:Number.MAX_VALUE,firstRowAsNames:true,switchRowsAndColumns:false};return DataConverter}();(function(DataConverter){function getTableFromColumns(columns,headers){if(columns===void 0){columns=[]}if(headers===void 0){headers=[]}var table=new Data_DataTable;for(var i=0,iEnd=Math.max(headers.length,columns.length);i<iEnd;++i){table.setColumn(headers[i]||"".concat(i),columns[i])}return table}DataConverter.getTableFromColumns=getTableFromColumns})(DataConverter||(DataConverter={}));var Converters_DataConverter=DataConverter;var DataCursor=function(){function DataCursor(stateMap){if(stateMap===void 0){stateMap={}}this.emittingRegister=[];this.listenerMap={};this.stateMap=stateMap}DataCursor.prototype.addListener=function(tableId,state,listener){var listenerMap=this.listenerMap[tableId]=this.listenerMap[tableId]||{};var listeners=listenerMap[state]=listenerMap[state]||[];listeners.push(listener);return this};DataCursor.prototype.buildEmittingTag=function(e){return(e.cursor.type==="position"?[e.table.id,e.cursor.column,e.cursor.row,e.cursor.state,e.cursor.type]:[e.table.id,e.cursor.columns,e.cursor.firstRow,e.cursor.lastRow,e.cursor.state,e.cursor.type]).join("\0")};DataCursor.prototype.emitCursor=function(table,cursor,event,lasting){var _a;var tableId=table.id,state=cursor.state,listeners=this.listenerMap[tableId]&&this.listenerMap[tableId][state];if(listeners){var stateMap=this.stateMap[tableId]=(_a=this.stateMap[tableId])!==null&&_a!==void 0?_a:{};var cursors=stateMap[cursor.state]||[];if(lasting){if(!cursors.length){stateMap[cursor.state]=cursors}if(DataCursor.getIndex(cursor,cursors)===-1){cursors.push(cursor)}}var e={cursor:cursor,cursors:cursors,table:table};if(event){e.event=event}var emittingRegister=this.emittingRegister,emittingTag=this.buildEmittingTag(e);if(emittingRegister.indexOf(emittingTag)>=0){return this}try{this.emittingRegister.push(emittingTag);for(var i=0,iEnd=listeners.length;i<iEnd;++i){listeners[i].call(this,e)}}finally{var index=this.emittingRegister.indexOf(emittingTag);if(index>=0){this.emittingRegister.splice(index,1)}}}return this};DataCursor.prototype.remitCursor=function(tableId,cursor){var cursors=this.stateMap[tableId]&&this.stateMap[tableId][cursor.state];if(cursors){var index=DataCursor.getIndex(cursor,cursors);if(index>=0){cursors.splice(index,1)}}return this};DataCursor.prototype.removeListener=function(tableId,state,listener){var listeners=this.listenerMap[tableId]&&this.listenerMap[tableId][state];if(listeners){var index=listeners.indexOf(listener);if(index>=0){listeners.splice(index,1)}}return this};DataCursor.version="1.0.0";return DataCursor}();(function(DataCursor){function getIndex(needle,cursors){if(needle.type==="position"){for(var cursor=void 0,i=0,iEnd=cursors.length;i<iEnd;++i){cursor=cursors[i];if(cursor.type==="position"&&cursor.state===needle.state&&cursor.column===needle.column&&cursor.row===needle.row){return i}}}else{var columnNeedle=JSON.stringify(needle.columns);for(var cursor=void 0,i=0,iEnd=cursors.length;i<iEnd;++i){cursor=cursors[i];if(cursor.type==="range"&&cursor.state===needle.state&&cursor.firstRow===needle.firstRow&&cursor.lastRow===needle.lastRow&&JSON.stringify(cursor.columns)===columnNeedle){return i}}}return-1}DataCursor.getIndex=getIndex;function isEqual(cursorA,cursorB){if(cursorA.type==="position"&&cursorB.type==="position"){return cursorA.column===cursorB.column&&cursorA.row===cursorB.row&&cursorA.state===cursorB.state}if(cursorA.type==="range"&&cursorB.type==="range"){return cursorA.firstRow===cursorB.firstRow&&cursorA.lastRow===cursorB.lastRow&&JSON.stringify(cursorA.columns)===JSON.stringify(cursorB.columns)}return false}DataCursor.isEqual=isEqual;function isInRange(needle,range){if(range.type==="position"){range=toRange(range)}if(needle.type==="position"){needle=toRange(needle,range)}var needleColumns=needle.columns;var rangeColumns=range.columns;return needle.firstRow>=range.firstRow&&needle.lastRow<=range.lastRow&&(!needleColumns||!rangeColumns||needleColumns.every(function(column){return rangeColumns.indexOf(column)>=0}))}DataCursor.isInRange=isInRange;function toPositions(cursor){if(cursor.type==="position"){return[cursor]}var columns=cursor.columns||[];var positions=[];var state=cursor.state;for(var row=cursor.firstRow,rowEnd=cursor.lastRow;row<rowEnd;++row){if(!columns.length){positions.push({type:"position",row:row,state:state});continue}for(var column=0,columnEnd=columns.length;column<columnEnd;++column){positions.push({type:"position",column:columns[column],row:row,state:state})}}return positions}DataCursor.toPositions=toPositions;function toRange(cursor,defaultRange){var _a,_b,_c,_d;if(cursor.type==="range"){return cursor}var range={type:"range",firstRow:(_b=(_a=cursor.row)!==null&&_a!==void 0?_a:defaultRange&&defaultRange.firstRow)!==null&&_b!==void 0?_b:0,lastRow:(_d=(_c=cursor.row)!==null&&_c!==void 0?_c:defaultRange&&defaultRange.lastRow)!==null&&_d!==void 0?_d:Number.MAX_VALUE,state:cursor.state};if(typeof cursor.column!=="undefined"){range.columns=[cursor.column]}return range}DataCursor.toRange=toRange})(DataCursor||(DataCursor={}));var Data_DataCursor=DataCursor;var DataPoolDefaults={connectors:[]};var Data_DataPoolDefaults=DataPoolDefaults;var DataPool=function(){function DataPool(options){if(options===void 0){options=Data_DataPoolDefaults}options.connectors=options.connectors||[];this.connectors={};this.options=options;this.waiting={}}DataPool.prototype.emit=function(e){highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().fireEvent(this,e.type,e)};DataPool.prototype.getConnector=function(connectorId){var _this=this;var connector=this.connectors[connectorId];if(connector){return Promise.resolve(connector)}var waitingList=this.waiting[connectorId];if(!waitingList){waitingList=this.waiting[connectorId]=[];var connectorOptions=this.getConnectorOptions(connectorId);if(!connectorOptions){throw new Error("Connector '".concat(connectorId,"' not found."))}this.loadConnector(connectorOptions).then(function(connector){delete _this.waiting[connectorId];for(var i=0,iEnd=waitingList.length;i<iEnd;++i){waitingList[i][0](connector)}})["catch"](function(error){delete _this.waiting[connectorId];for(var i=0,iEnd=waitingList.length;i<iEnd;++i){waitingList[i][1](error)}})}return new Promise(function(resolve,reject){waitingList.push([resolve,reject])})};DataPool.prototype.getConnectorIds=function(){var connectors=this.options.connectors,connectorIds=[];for(var i=0,iEnd=connectors.length;i<iEnd;++i){connectorIds.push(connectors[i].id)}return connectorIds};DataPool.prototype.getConnectorOptions=function(connectorId){var connectors=this.options.connectors;for(var i=0,iEnd=connectors.length;i<iEnd;++i){if(connectors[i].id===connectorId){return connectors[i]}}};DataPool.prototype.getConnectorTable=function(connectorId){return this.getConnector(connectorId).then(function(connector){return connector.table})};DataPool.prototype.isNewConnector=function(connectorId){return!this.connectors[connectorId]};DataPool.prototype.loadConnector=function(options){var _this=this;return new Promise(function(resolve,reject){_this.emit({type:"load",options:options});var ConnectorClass=Connectors_DataConnector.types[options.type];if(!ConnectorClass){throw new Error("Connector type not found. (".concat(options.type,")"))}var connector=new ConnectorClass(options.options);connector.load().then(function(connector){_this.connectors[options.id]=connector;_this.emit({type:"afterLoad",options:options});resolve(connector)})["catch"](reject)})};DataPool.prototype.on=function(type,callback){return highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().addEvent(this,type,callback)};DataPool.prototype.setConnectorOptions=function(options){var connectors=this.options.connectors,instances=this.connectors;this.emit({type:"setConnectorOptions",options:options});for(var i=0,iEnd=connectors.length;i<iEnd;++i){if(connectors[i].id===options.id){connectors.splice(i,1);break}}if(instances[options.id]){instances[options.id].stopPolling();delete instances[options.id]}connectors.push(options);this.emit({type:"afterSetConnectorOptions",options:options})};DataPool.version="1.0.0";return DataPool}();var Data_DataPool=DataPool;var booleanRegExp=/^(?:FALSE|TRUE)/;var decimal1RegExp=/^[+\-]?\d+(?:\.\d+)?(?:e[+\-]\d+)?/;var decimal2RegExp=/^[+\-]?\d+(?:,\d+)?(?:e[+\-]\d+)?/;var functionRegExp=/^([A-Z][A-Z\d\.]*)\(/;var operatorRegExp=/^(?:[+\-*\/^<=>]|<=|=>)/;var rangeA1RegExp=/^(\$?[A-Z]+)(\$?\d+)\:(\$?[A-Z]+)(\$?\d+)/;var rangeR1C1RegExp=/^R(\d*|\[\d+\])C(\d*|\[\d+\])\:R(\d*|\[\d+\])C(\d*|\[\d+\])/;var referenceA1RegExp=/^(\$?[A-Z]+)(\$?\d+)(?![\:C])/;var referenceR1C1RegExp=/^R(\d*|\[\d+\])C(\d*|\[\d+\])(?!\:)/;function extractParantheses(text){var parantheseLevel=0;for(var i=0,iEnd=text.length,char=void 0,parantheseStart=1;i<iEnd;++i){char=text[i];if(char==="("){if(!parantheseLevel){parantheseStart=i+1}++parantheseLevel;continue}if(char===")"){--parantheseLevel;if(!parantheseLevel){return text.substring(parantheseStart,i)}}}if(parantheseLevel>0){var error=new Error("Incomplete parantheses.");error.name="FormulaParseError";throw error}return""}function extractString(text){var start=-1;for(var i=0,iEnd=text.length,char=void 0,escaping=false;i<iEnd;++i){char=text[i];if(char==="\\"){escaping=!escaping;continue}if(escaping){escaping=false;continue}if(char==='"'){if(start<0){start=i}else{return text.substring(start+1,i)}}}var error=new Error("Incomplete string.");error.name="FormulaParseError";throw error}function parseArgument(text,alternativeSeparators){var match;match=text.match(rangeR1C1RegExp);if(match){var beginColumnRelative=match[2]===""||match[2][0]==="[";var beginRowRelative=match[1]===""||match[1][0]==="[";var endColumnRelative=match[4]===""||match[4][0]==="[";var endRowRelative=match[3]===""||match[3][0]==="[";var range={type:"range",beginColumn:beginColumnRelative?parseInt(match[2].substring(1,-1)||"0",10):parseInt(match[2],10)-1,beginRow:beginRowRelative?parseInt(match[1].substring(1,-1)||"0",10):parseInt(match[1],10)-1,endColumn:endColumnRelative?parseInt(match[4].substring(1,-1)||"0",10):parseInt(match[4],10)-1,endRow:endRowRelative?parseInt(match[3].substring(1,-1)||"0",10):parseInt(match[3],10)-1};if(beginColumnRelative){range.beginColumnRelative=true}if(beginRowRelative){range.beginRowRelative=true}if(endColumnRelative){range.endColumnRelative=true}if(endRowRelative){range.endRowRelative=true}return range}match=text.match(rangeA1RegExp);if(match){var beginColumnRelative=match[1][0]!=="$";var beginRowRelative=match[2][0]!=="$";var endColumnRelative=match[3][0]!=="$";var endRowRelative=match[4][0]!=="$";var range={type:"range",beginColumn:parseReferenceColumn(beginColumnRelative?match[1]:match[1].substring(1))-1,beginRow:parseInt(beginRowRelative?match[2]:match[2].substring(1),10)-1,endColumn:parseReferenceColumn(endColumnRelative?match[3]:match[3].substring(1))-1,endRow:parseInt(endRowRelative?match[4]:match[4].substring(1),10)-1};if(beginColumnRelative){range.beginColumnRelative=true}if(beginRowRelative){range.beginRowRelative=true}if(endColumnRelative){range.endColumnRelative=true}if(endRowRelative){range.endRowRelative=true}return range}var formula=parseFormula(text,alternativeSeparators);return formula.length===1&&typeof formula[0]!=="string"?formula[0]:formula}function parseArguments(text,alternativeSeparators){var args=[],argumentsSeparator=alternativeSeparators?";":",";var parantheseLevel=0,term="";for(var i=0,iEnd=text.length,char=void 0;i<iEnd;++i){char=text[i];if(char===argumentsSeparator&&!parantheseLevel&&term){args.push(parseArgument(term,alternativeSeparators));term=""}else if(char==='"'&&!parantheseLevel&&!term){var string=extractString(text.substring(i));args.push(string);i+=string.length+1}else if(char!==" "){term+=char;if(char==="("){++parantheseLevel}else if(char===")"){--parantheseLevel}}}if(!parantheseLevel&&term){args.push(parseArgument(term,alternativeSeparators))}return args}function parseFormula(text,alternativeSeparators){var decimalRegExp=alternativeSeparators?decimal2RegExp:decimal1RegExp,formula=[];var match,next=(text[0]==="="?text.substring(1):text).trim();while(next){match=next.match(referenceR1C1RegExp);if(match){var columnRelative=match[2]===""||match[2][0]==="[";var rowRelative=match[1]===""||match[1][0]==="[";var reference={type:"reference",column:columnRelative?parseInt(match[2].substring(1,-1)||"0",10):parseInt(match[2],10)-1,row:rowRelative?parseInt(match[1].substring(1,-1)||"0",10):parseInt(match[1],10)-1};if(columnRelative){reference.columnRelative=true}if(rowRelative){reference.rowRelative=true}formula.push(reference);next=next.substring(match[0].length).trim();continue}match=next.match(referenceA1RegExp);if(match){var columnRelative=match[1][0]!=="$";var rowRelative=match[2][0]!=="$";var reference={type:"reference",column:parseReferenceColumn(columnRelative?match[1]:match[1].substring(1))-1,row:parseInt(rowRelative?match[2]:match[2].substring(1),10)-1};if(columnRelative){reference.columnRelative=true}if(rowRelative){reference.rowRelative=true}formula.push(reference);next=next.substring(match[0].length).trim();continue}match=next.match(operatorRegExp);if(match){formula.push(match[0]);next=next.substring(match[0].length).trim();continue}match=next.match(booleanRegExp);if(match){formula.push(match[0]==="TRUE");next=next.substring(match[0].length).trim();continue}match=next.match(decimalRegExp);if(match){formula.push(parseFloat(match[0]));next=next.substring(match[0].length).trim();continue}if(next[0]==='"'){var string=extractString(next);formula.push(string.substring(1,-1));next=next.substring(string.length+2).trim();continue}match=next.match(functionRegExp);if(match){next=next.substring(match[1].length).trim();var parantheses=extractParantheses(next);formula.push({type:"function",name:match[1],args:parseArguments(parantheses,alternativeSeparators)});next=next.substring(parantheses.length+2).trim();continue}if(next[0]==="("){var paranteses=extractParantheses(next);if(paranteses){formula.push(parseFormula(paranteses,alternativeSeparators));next=next.substring(paranteses.length+2).trim();continue}}var position=text.length-next.length,error=new Error("Unexpected character `"+text.substring(position,position+1)+"` at position "+(position+1)+". (`..."+text.substring(position-5,position+6)+"...`)");error.name="FormulaParseError";throw error}return formula}function parseReferenceColumn(text){var column=0;for(var i=0,iEnd=text.length,code=void 0,factor=text.length-1;i<iEnd;++i){code=text.charCodeAt(i);if(code>=65&&code<=90){column+=(code-64)*Math.pow(26,factor)}--factor}return column}var FormulaParser={parseFormula:parseFormula};var Formula_FormulaParser=FormulaParser;var operators=["+","-","*","/","^","=","<","<=",">",">="];function isFormula(item){return item instanceof Array}function isFunction(item){return typeof item==="object"&&!(item instanceof Array)&&item.type==="function"}function isOperator(item){return typeof item==="string"&&operators.indexOf(item)>=0}function isRange(item){return typeof item==="object"&&!(item instanceof Array)&&item.type==="range"}function isReference(item){return typeof item==="object"&&!(item instanceof Array)&&item.type==="reference"}function isValue(item){return typeof item==="boolean"||typeof item==="number"||typeof item==="string"}var MathFormula={isFormula:isFormula,isFunction:isFunction,isOperator:isOperator,isRange:isRange,isReference:isReference,isValue:isValue};var FormulaTypes=MathFormula;var FormulaProcessor_isFormula=FormulaTypes.isFormula,FormulaProcessor_isFunction=FormulaTypes.isFunction,FormulaProcessor_isOperator=FormulaTypes.isOperator,FormulaProcessor_isRange=FormulaTypes.isRange,FormulaProcessor_isReference=FormulaTypes.isReference,FormulaProcessor_isValue=FormulaTypes.isValue;var asLogicalStringRegExp=/ */;var MAX_FALSE=Number.MAX_VALUE/1.000000000001;var MAX_STRING=Number.MAX_VALUE/1.000000000002;var MAX_TRUE=Number.MAX_VALUE;var operatorPriority={"^":3,"*":2,"/":2,"+":1,"-":1,"=":0,"<":0,"<=":0,">":0,">=":0};var processorFunctions={};var processorFunctionNameRegExp=/^[A-Z][A-Z\.]*$/;function asLogicalNumber(value){switch(typeof value){case"boolean":return value?MAX_TRUE:MAX_FALSE;case"string":return MAX_STRING;case"number":return value;default:return NaN}}function asLogicalString(value){if(typeof value==="string"){return value.toLowerCase().replace(asLogicalStringRegExp,"\0")}return value}function asNumber(value){switch(typeof value){case"boolean":return value?1:0;case"string":return parseFloat(value.replace(",","."));case"number":return value;default:return NaN}}function basicOperation(operator,x,y){switch(operator){case"=":return asLogicalString(x)===asLogicalString(y);case"<":if(typeof x===typeof y){return asLogicalString(x)<asLogicalString(y)}return asLogicalNumber(x)<asLogicalNumber(y);case"<=":if(typeof x===typeof y){return asLogicalString(x)<=asLogicalString(y)}return asLogicalNumber(x)<=asLogicalNumber(y);case">":if(typeof x===typeof y){return asLogicalString(x)>asLogicalString(y)}return asLogicalNumber(x)>asLogicalNumber(y);case">=":if(typeof x===typeof y){return asLogicalString(x)>=asLogicalString(y)}return asLogicalNumber(x)>=asLogicalNumber(y)}x=asNumber(x);y=asNumber(y);var result;switch(operator){case"+":result=x+y;break;case"-":result=x-y;break;case"*":result=x*y;break;case"/":result=x/y;break;case"^":result=Math.pow(x,y);break;default:return NaN}return result%1?Math.round(result*1e9)/1e9:result}function getArgumentValue(arg,table){if(FormulaProcessor_isValue(arg)){return arg}if(FormulaProcessor_isRange(arg)){return table&&getRangeValues(arg,table)||[]}if(FormulaProcessor_isFunction(arg)){return processFunction(arg,table)}return processFormula(FormulaProcessor_isFormula(arg)?arg:[arg],table)}function getArgumentsValues(args,table){var values=[];for(var i=0,iEnd=args.length;i<iEnd;++i){values.push(getArgumentValue(args[i],table))}return values}function getRangeValues(range,table){var columnNames=table.getColumnNames().slice(range.beginColumn,range.endColumn+1),values=[];for(var i=0,iEnd=columnNames.length,cell=void 0;i<iEnd;++i){var cells=table.getColumn(columnNames[i],true)||[];for(var j=range.beginRow,jEnd=range.endRow+1;j<jEnd;++j){cell=cells[j];if(typeof cell==="string"&&cell[0]==="="&&table!==table.modified){cell=table.modified.getCell(columnNames[i],j)}values.push(FormulaProcessor_isValue(cell)?cell:NaN)}}return values}function getReferenceValue(reference,table){var columnName=table.getColumnNames()[reference.column];if(columnName){var cell=table.getCell(columnName,reference.row);if(typeof cell==="string"&&cell[0]==="="&&table!==table.modified){var result=table.modified.getCell(columnName,reference.row);return FormulaProcessor_isValue(result)?result:NaN}return FormulaProcessor_isValue(cell)?cell:NaN}return NaN}function processFormula(formula,table){var x;for(var i=0,iEnd=formula.length,item=void 0,operator=void 0,result=void 0,y=void 0;i<iEnd;++i){item=formula[i];if(FormulaProcessor_isOperator(item)){operator=item;continue}if(FormulaProcessor_isValue(item)){y=item}else if(FormulaProcessor_isFormula(item)){y=processFormula(formula,table)}else if(FormulaProcessor_isFunction(item)){result=processFunction(item,table);y=FormulaProcessor_isValue(result)?result:NaN}else if(FormulaProcessor_isReference(item)){y=table&&getReferenceValue(item,table)}if(typeof y!=="undefined"){if(typeof x==="undefined"){if(operator){x=basicOperation(operator,0,y)}else{x=y}}else if(!operator){return NaN}else{var operator2=formula[i+1];if(FormulaProcessor_isOperator(operator2)&&operatorPriority[operator2]>operatorPriority[operator]){y=basicOperation(operator2,y,processFormula(formula.slice(i+2)));i=iEnd}x=basicOperation(operator,x,y)}operator=void 0;y=void 0}}return FormulaProcessor_isValue(x)?x:NaN}function processFunction(formulaFunction,table,reference){var processor=processorFunctions[formulaFunction.name];if(processor){try{return processor(formulaFunction.args,table)}catch(_a){return NaN}}var error=new Error('Function "'.concat(formulaFunction.name,'" not found.'));error.name="FormulaProcessError";throw error}function registerProcessorFunction(name,processorFunction){return processorFunctionNameRegExp.test(name)&&!processorFunctions[name]&&!!(processorFunctions[name]=processorFunction)}function translateReferences(formula,columnDelta,rowDelta){if(columnDelta===void 0){columnDelta=0}if(rowDelta===void 0){rowDelta=0}for(var i=0,iEnd=formula.length,item=void 0;i<iEnd;++i){item=formula[i];if(item instanceof Array){translateReferences(item,columnDelta,rowDelta)}else if(FormulaProcessor_isFunction(item)){translateReferences(item.args,columnDelta,rowDelta)}else if(FormulaProcessor_isRange(item)){if(item.beginColumnRelative){item.beginColumn+=columnDelta}if(item.beginRowRelative){item.beginRow+=rowDelta}if(item.endColumnRelative){item.endColumn+=columnDelta}if(item.endRowRelative){item.endRow+=rowDelta}}else if(FormulaProcessor_isReference(item)){if(item.columnRelative){item.column+=columnDelta}if(item.rowRelative){item.row+=rowDelta}}}return formula}var FormulaProcessor={asNumber:asNumber,getArgumentValue:getArgumentValue,getArgumentsValues:getArgumentsValues,getRangeValues:getRangeValues,getReferenceValue:getReferenceValue,processFormula:processFormula,processorFunctions:processorFunctions,registerProcessorFunction:registerProcessorFunction,translateReferences:translateReferences};var Formula_FormulaProcessor=FormulaProcessor;var ABS_getArgumentValue=Formula_FormulaProcessor.getArgumentValue;function ABS(args,table){var value=ABS_getArgumentValue(args[0],table);switch(typeof value){case"number":return Math.abs(value);case"object":{var values=[];for(var i=0,iEnd=value.length,value2=void 0;i<iEnd;++i){value2=value[i];if(typeof value2!=="number"){return NaN}values.push(Math.abs(value2))}return values}default:return NaN}}Formula_FormulaProcessor.registerProcessorFunction("ABS",ABS);var Functions_ABS=null&&ABS;var AND_getArgumentValue=Formula_FormulaProcessor.getArgumentValue;function AND(args,table){for(var i=0,iEnd=args.length,value=void 0;i<iEnd;++i){value=AND_getArgumentValue(args[i],table);if(!value||typeof value==="object"&&!AND(value,table)){return false}}return true}Formula_FormulaProcessor.registerProcessorFunction("AND",AND);var Functions_AND=null&&AND;var AVERAGE_getArgumentsValues=Formula_FormulaProcessor.getArgumentsValues;function AVERAGE(args,table){var values=AVERAGE_getArgumentsValues(args,table);var count=0,result=0;for(var i=0,iEnd=values.length,value=void 0;i<iEnd;++i){value=values[i];switch(typeof value){case"number":if(!isNaN(value)){++count;result+=value}break;case"object":for(var j=0,jEnd=value.length,value2=void 0;j<jEnd;++j){value2=value[j];if(typeof value2==="number"&&!isNaN(value2)){++count;result+=value2}}break}}return count?result/count:0}Formula_FormulaProcessor.registerProcessorFunction("AVERAGE",AVERAGE);var Functions_AVERAGE=null&&AVERAGE;var AVERAGEA_getArgumentValue=Formula_FormulaProcessor.getArgumentValue;function AVERAGEA(args,table){var count=0,result=0;for(var i=0,iEnd=args.length,value=void 0;i<iEnd;++i){value=AVERAGEA_getArgumentValue(args[i],table);switch(typeof value){case"boolean":++count;result+=value?1:0;continue;case"number":if(!isNaN(value)){++count;result+=value}continue;case"string":++count;continue;default:for(var j=0,jEnd=value.length,value2=void 0;j<jEnd;++j){value2=value[j];switch(typeof value2){case"boolean":++count;result+=value2?1:0;continue;case"number":if(!isNaN(value2)){++count;result+=value2}continue;case"string":++count;continue}}continue}}return count?result/count:0}Formula_FormulaProcessor.registerProcessorFunction("AVERAGEA",AVERAGEA);var Functions_AVERAGEA=null&&AVERAGEA;function COUNT(args,table){var values=Formula_FormulaProcessor.getArgumentsValues(args,table);var count=0;for(var i=0,iEnd=values.length,value=void 0;i<iEnd;++i){value=values[i];switch(typeof value){case"number":if(!isNaN(value)){++count}break;case"object":count+=COUNT(value,table);break}}return count}Formula_FormulaProcessor.registerProcessorFunction("COUNT",COUNT);var Functions_COUNT=null&&COUNT;function COUNTA(args,table){var values=Formula_FormulaProcessor.getArgumentsValues(args,table);var count=0;for(var i=0,iEnd=values.length,value=void 0;i<iEnd;++i){value=values[i];switch(typeof value){case"number":if(isNaN(value)){continue}break;case"object":count+=COUNTA(value,table);continue;case"string":if(!value){continue}break}++count}return count}Formula_FormulaProcessor.registerProcessorFunction("COUNTA",COUNTA);var Functions_COUNTA=null&&COUNTA;var IF_getArgumentValue=Formula_FormulaProcessor.getArgumentValue;function IF(args,table){return IF_getArgumentValue(args[0],table)?IF_getArgumentValue(args[1],table):IF_getArgumentValue(args[2],table)}Formula_FormulaProcessor.registerProcessorFunction("IF",IF);var Functions_IF=null&&IF;var ISNA_getArgumentValue=Formula_FormulaProcessor.getArgumentValue;function ISNA(args,table){var value=ISNA_getArgumentValue(args[0],table);return typeof value!=="number"||isNaN(value)}Formula_FormulaProcessor.registerProcessorFunction("ISNA",ISNA);var Functions_ISNA=null&&ISNA;var MAX_getArgumentsValues=Formula_FormulaProcessor.getArgumentsValues;function MAX(args,table){var values=MAX_getArgumentsValues(args,table);var result=Number.NEGATIVE_INFINITY;for(var i=0,iEnd=values.length,value=void 0;i<iEnd;++i){value=values[i];switch(typeof value){case"number":if(value>result){result=value}break;case"object":value=MAX(value);if(value>result){result=value}break}}return isFinite(result)?result:0}Formula_FormulaProcessor.registerProcessorFunction("MAX",MAX);var Functions_MAX=null&&MAX;function MEDIAN(args,table){var median=[],values=Formula_FormulaProcessor.getArgumentsValues(args,table);for(var i=0,iEnd=values.length,value=void 0;i<iEnd;++i){value=values[i];switch(typeof value){case"number":if(!isNaN(value)){median.push(value)}break;case"object":for(var j=0,jEnd=value.length,value2=void 0;j<jEnd;++j){value2=value[j];if(typeof value2==="number"&&!isNaN(value2)){median.push(value2)}}break}}var count=median.length;if(!count){return NaN}var half=Math.floor(count/2);return count%2?median[half]:(median[half-1]+median[half])/2}Formula_FormulaProcessor.registerProcessorFunction("MEDIAN",MEDIAN);var Functions_MEDIAN=null&&MEDIAN;var MIN_getArgumentsValues=Formula_FormulaProcessor.getArgumentsValues;function MIN(args,table){var values=MIN_getArgumentsValues(args,table);var result=Number.POSITIVE_INFINITY;for(var i=0,iEnd=values.length,value=void 0;i<iEnd;++i){value=values[i];switch(typeof value){case"number":if(value<result){result=value}break;case"object":value=MIN(value);if(value<result){result=value}break}}return isFinite(result)?result:0}Formula_FormulaProcessor.registerProcessorFunction("MIN",MIN);var Functions_MIN=null&&MIN;var MOD_getArgumentValue=Formula_FormulaProcessor.getArgumentValue;function MOD(args,table){var value1=MOD_getArgumentValue(args[0],table),value2=MOD_getArgumentValue(args[1],table);if(typeof value1==="object"){value1=value1[0]}if(typeof value2==="object"){value2=value2[0]}if(typeof value1!=="number"||typeof value2!=="number"||value2===0){return NaN}return value1%value2}Formula_FormulaProcessor.registerProcessorFunction("MOD",MOD);var Functions_MOD=null&&MOD;function getModeMap(args,table){var modeMap={},values=Formula_FormulaProcessor.getArgumentsValues(args,table);for(var i=0,iEnd=values.length,value=void 0;i<iEnd;++i){value=values[i];switch(typeof value){case"number":if(!isNaN(value)){modeMap[value]=(modeMap[value]||0)+1}break;case"object":for(var j=0,jEnd=value.length,value2=void 0;j<jEnd;++j){value2=value[j];if(typeof value2==="number"&&!isNaN(value2)){modeMap[value2]=(modeMap[value2]||0)+1}}break}}return modeMap}function MULT(args,table){var modeMap=getModeMap(args,table),keys=Object.keys(modeMap);if(!keys.length){return NaN}var modeKeys=[parseFloat(keys[0])],modeCount=modeMap[keys[0]];for(var i=1,iEnd=keys.length,key=void 0,count=void 0;i<iEnd;++i){key=keys[i];count=modeMap[key];if(modeCount<count){modeKeys=[parseFloat(key)];modeCount=count}else if(modeCount===count){modeKeys.push(parseFloat(key))}}return modeCount>1?modeKeys:NaN}function SNGL(args,table){var modeMap=getModeMap(args,table),keys=Object.keys(modeMap);if(!keys.length){return NaN}var modeKey=parseFloat(keys[0]),modeCount=modeMap[keys[0]];for(var i=1,iEnd=keys.length,key=void 0,keyValue=void 0,count=void 0;i<iEnd;++i){key=keys[i];count=modeMap[key];if(modeCount<count){modeKey=parseFloat(key);modeCount=count}else if(modeCount===count){keyValue=parseFloat(key);if(modeKey>keyValue){modeKey=keyValue;modeCount=count}}}return modeCount>1?modeKey:NaN}Formula_FormulaProcessor.registerProcessorFunction("MODE",SNGL);Formula_FormulaProcessor.registerProcessorFunction("MODE.MULT",MULT);Formula_FormulaProcessor.registerProcessorFunction("MODE.SNGL",SNGL);var MODE={MULT:MULT,SNGL:SNGL};var Functions_MODE=null&&MODE;var NOT_getArgumentValue=Formula_FormulaProcessor.getArgumentValue;function NOT(args,table){var value=NOT_getArgumentValue(args[0],table);if(typeof value==="object"){value=value[0]}switch(typeof value){case"boolean":case"number":return!value}return NaN}Formula_FormulaProcessor.registerProcessorFunction("NOT",NOT);var Functions_NOT=null&&NOT;var OR_getArgumentValue=Formula_FormulaProcessor.getArgumentValue;function OR(args,table){for(var i=0,iEnd=args.length,value=void 0;i<iEnd;++i){value=OR_getArgumentValue(args[i],table);if(typeof value==="object"){if(OR(value,table)){return true}}else if(value){return true}}return false}Formula_FormulaProcessor.registerProcessorFunction("OR",OR);var Functions_OR=null&&OR;var PRODUCT_getArgumentsValues=Formula_FormulaProcessor.getArgumentsValues;function PRODUCT(args,table){var values=PRODUCT_getArgumentsValues(args,table);var result=1,calculated=false;for(var i=0,iEnd=values.length,value=void 0;i<iEnd;++i){value=values[i];switch(typeof value){case"number":if(!isNaN(value)){calculated=true;result*=value}break;case"object":calculated=true;result*=PRODUCT(value,table);break}}return calculated?result:0}Formula_FormulaProcessor.registerProcessorFunction("PRODUCT",PRODUCT);var Functions_PRODUCT=null&&PRODUCT;function SUM(args,table){var values=Formula_FormulaProcessor.getArgumentsValues(args,table);var result=0;for(var i=0,iEnd=values.length,value=void 0;i<iEnd;++i){value=values[i];switch(typeof value){case"number":if(!isNaN(value)){result+=value}break;case"object":result+=SUM(value,table);break}}return result}Formula_FormulaProcessor.registerProcessorFunction("SUM",SUM);var Functions_SUM=null&&SUM;var XOR_getArgumentValue=Formula_FormulaProcessor.getArgumentValue;function XOR(args,table){for(var i=0,iEnd=args.length,lastValue=void 0,value=void 0;i<iEnd;++i){value=XOR_getArgumentValue(args[i],table);switch(typeof value){case"boolean":case"number":if(typeof lastValue==="undefined"){lastValue=!!value}else if(!!value!==lastValue){return true}break;case"object":for(var j=0,jEnd=value.length,value2=void 0;j<jEnd;++j){value2=value[j];switch(typeof value2){case"boolean":case"number":if(typeof lastValue==="undefined"){lastValue=!!value2}else if(!!value2!==lastValue){return true}break}}break}}return false}Formula_FormulaProcessor.registerProcessorFunction("XOR",XOR);var Functions_XOR=null&&XOR;var __assign=undefined&&undefined.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};var Formula=__assign(__assign(__assign({},Formula_FormulaParser),Formula_FormulaProcessor),FormulaTypes);var Formula_Formula=Formula;var CSVConverter_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var CSVConverter_assign=undefined&&undefined.__assign||function(){CSVConverter_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return CSVConverter_assign.apply(this,arguments)};var CSVConverter_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge;var CSVConverter=function(_super){CSVConverter_extends(CSVConverter,_super);function CSVConverter(options){var _this=this;var mergedOptions=CSVConverter_merge(CSVConverter.defaultOptions,options);_this=_super.call(this,mergedOptions)||this;_this.columns=[];_this.headers=[];_this.dataTypes=[];_this.options=mergedOptions;return _this}CSVConverter.prototype.export=function(connector,options){if(options===void 0){options=this.options}var useLocalDecimalPoint=options.useLocalDecimalPoint,lineDelimiter=options.lineDelimiter,exportNames=this.options.firstRowAsNames!==false;var decimalPoint=options.decimalPoint,itemDelimiter=options.itemDelimiter;if(!decimalPoint){decimalPoint=itemDelimiter!==","&&useLocalDecimalPoint?1.1.toLocaleString()[1]:"."}if(!itemDelimiter){itemDelimiter=decimalPoint===","?";":","}var columns=connector.getSortedColumns(options.usePresentationOrder),columnNames=Object.keys(columns),csvRows=[],columnsCount=columnNames.length;var rowArray=[];if(exportNames){csvRows.push(columnNames.map(function(columnName){return'"'.concat(columnName,'"')}).join(itemDelimiter))}for(var columnIndex=0;columnIndex<columnsCount;columnIndex++){var columnName=columnNames[columnIndex],column=columns[columnName],columnLength=column.length;var columnMeta=connector.whatIs(columnName);var columnDataType=void 0;if(columnMeta){columnDataType=columnMeta.dataType}for(var rowIndex=0;rowIndex<columnLength;rowIndex++){var cellValue=column[rowIndex];if(!rowArray[rowIndex]){rowArray[rowIndex]=[]}if(columnDataType==="string"){cellValue='"'+cellValue+'"'}else if(typeof cellValue==="number"){cellValue=String(cellValue).replace(".",decimalPoint)}else if(typeof cellValue==="string"){cellValue='"'.concat(cellValue,'"')}rowArray[rowIndex][columnIndex]=cellValue;if(columnIndex===columnsCount-1){var i=columnIndex;while(rowArray[rowIndex].length>2){var cellVal=rowArray[rowIndex][i];if(cellVal!==void 0){break}rowArray[rowIndex].pop();i--}csvRows.push(rowArray[rowIndex].join(itemDelimiter))}}}return csvRows.join(lineDelimiter)};CSVConverter.prototype.parse=function(options,eventDetail){var converter=this,dataTypes=converter.dataTypes,parserOptions=CSVConverter_merge(this.options,options),beforeParse=parserOptions.beforeParse,lineDelimiter=parserOptions.lineDelimiter,firstRowAsNames=parserOptions.firstRowAsNames,itemDelimiter=parserOptions.itemDelimiter;var lines,rowIt=0,csv=parserOptions.csv,startRow=parserOptions.startRow,endRow=parserOptions.endRow,column;converter.columns=[];converter.emit({type:"parse",columns:converter.columns,detail:eventDetail,headers:converter.headers});if(csv&&beforeParse){csv=beforeParse(csv)}if(csv){lines=csv.replace(/\r\n|\r/g,"\n").split(lineDelimiter||"\n");if(!startRow||startRow<0){startRow=0}if(!endRow||endRow>=lines.length){endRow=lines.length-1}if(!itemDelimiter){converter.guessedItemDelimiter=converter.guessDelimiter(lines)}if(firstRowAsNames){var headers=lines[0].split(itemDelimiter||converter.guessedItemDelimiter||",");for(var i=0;i<headers.length;i++){headers[i]=headers[i].trim().replace(/^["']|["']$/g,"")}converter.headers=headers;startRow++}var offset=0;for(rowIt=startRow;rowIt<=endRow;rowIt++){if(lines[rowIt][0]==="#"){offset++}else{converter.parseCSVRow(lines[rowIt],rowIt-startRow-offset)}}if(dataTypes.length&&dataTypes[0].length&&dataTypes[0][1]==="date"&&!converter.options.dateFormat){converter.deduceDateFormat(converter.columns[0],null,true)}for(var i=0,iEnd=converter.columns.length;i<iEnd;++i){column=converter.columns[i];for(var j=0,jEnd=column.length;j<jEnd;++j){if(column[j]&&typeof column[j]==="string"){var cellValue=converter.asGuessedType(column[j]);if(cellValue instanceof Date){cellValue=cellValue.getTime()}converter.columns[i][j]=cellValue}}}}converter.emit({type:"afterParse",columns:converter.columns,detail:eventDetail,headers:converter.headers})};CSVConverter.prototype.parseCSVRow=function(columnStr,rowNumber){var converter=this,columns=converter.columns||[],dataTypes=converter.dataTypes,_a=converter.options,startColumn=_a.startColumn,endColumn=_a.endColumn,itemDelimiter=converter.options.itemDelimiter||converter.guessedItemDelimiter;var decimalPoint=converter.options.decimalPoint;if(!decimalPoint||decimalPoint===itemDelimiter){decimalPoint=converter.guessedDecimalPoint||"."}var i=0,c="",token="",actualColumn=0,column=0;var read=function(j){c=columnStr[j]};var pushType=function(type){if(dataTypes.length<column+1){dataTypes.push([type])}if(dataTypes[column][dataTypes[column].length-1]!==type){dataTypes[column].push(type)}};var push=function(){if(startColumn>actualColumn||actualColumn>endColumn){++actualColumn;token="";return}if(typeof token==="string"){if(!isNaN(parseFloat(token))&&isFinite(token)){token=parseFloat(token);pushType("number")}else if(!isNaN(Date.parse(token))){token=token.replace(/\//g,"-");pushType("date")}else{pushType("string")}}else{pushType("number")}if(columns.length<column+1){columns.push([])}if(typeof token!=="number"&&converter.guessType(token)!=="number"&&decimalPoint){var initialValue=token;token=token.replace(decimalPoint,".");if(converter.guessType(token)!=="number"){token=initialValue}}columns[column][rowNumber]=token;token="";++column;++actualColumn};if(!columnStr.trim().length){return}if(columnStr.trim()[0]==="#"){return}for(;i<columnStr.length;i++){read(i);if(c==="#"){if(!/^#[A-F\d]{3,3}|[A-F\d]{6,6}/i.test(columnStr.substring(i))){push();return}}if(c==='"'){read(++i);while(i<columnStr.length){if(c==='"'){break}token+=c;read(++i)}}else if(c===itemDelimiter){push()}else{token+=c}}push()};CSVConverter.prototype.guessDelimiter=function(lines){var points=0,commas=0,guessed;var potDelimiters={",":0,";":0,"\t":0},linesCount=lines.length;for(var i=0;i<linesCount;i++){var inStr=false,c=void 0,cn=void 0,cl=void 0,token="";if(i>13){break}var columnStr=lines[i];for(var j=0;j<columnStr.length;j++){c=columnStr[j];cn=columnStr[j+1];cl=columnStr[j-1];if(c==="#"){break}if(c==='"'){if(inStr){if(cl!=='"'&&cn!=='"'){while(cn===" "&&j<columnStr.length){cn=columnStr[++j]}if(typeof potDelimiters[cn]!=="undefined"){potDelimiters[cn]++}inStr=false}}else{inStr=true}}else if(typeof potDelimiters[c]!=="undefined"){token=token.trim();if(!isNaN(Date.parse(token))){potDelimiters[c]++}else if(isNaN(Number(token))||!isFinite(Number(token))){potDelimiters[c]++}token=""}else{token+=c}if(c===","){commas++}if(c==="."){points++}}}if(potDelimiters[";"]>potDelimiters[","]){guessed=";"}else if(potDelimiters[","]>potDelimiters[";"]){guessed=","}else{guessed=","}if(points>commas){this.guessedDecimalPoint="."}else{this.guessedDecimalPoint=","}return guessed};CSVConverter.prototype.getTable=function(){return Converters_DataConverter.getTableFromColumns(this.columns,this.headers)};CSVConverter.defaultOptions=CSVConverter_assign(CSVConverter_assign({},Converters_DataConverter.defaultOptions),{lineDelimiter:"\n"});return CSVConverter}(Converters_DataConverter);var Converters_CSVConverter=CSVConverter;var CSVConnector_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var CSVConnector_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge;var CSVConnector=function(_super){CSVConnector_extends(CSVConnector,_super);function CSVConnector(options){var _this=this;var mergedOptions=CSVConnector_merge(CSVConnector.defaultOptions,options);_this=_super.call(this,mergedOptions)||this;_this.converter=new Converters_CSVConverter(mergedOptions);_this.options=mergedOptions;if(mergedOptions.enablePolling){_this.startPolling(Math.max(mergedOptions.dataRefreshRate||0,1)*1e3)}return _this}CSVConnector.prototype.load=function(eventDetail){var connector=this,converter=connector.converter,table=connector.table,_a=connector.options,csv=_a.csv,csvURL=_a.csvURL,dataModifier=_a.dataModifier;connector.emit({type:"load",csv:csv,detail:eventDetail,table:table});return Promise.resolve(csvURL?fetch(csvURL).then(function(response){return response.text()}):csv||"").then(function(csv){if(csv){table.deleteColumns();converter.parse({csv:csv});table.setColumns(converter.getTable().getColumns())}return connector.setModifierOptions(dataModifier).then(function(){return csv})}).then(function(csv){connector.emit({type:"afterLoad",csv:csv,detail:eventDetail,table:table});return connector})["catch"](function(error){connector.emit({type:"loadError",detail:eventDetail,error:error,table:table});throw error})};CSVConnector.defaultOptions={csv:"",csvURL:"",enablePolling:false,dataRefreshRate:1,firstRowAsNames:true};return CSVConnector}(Connectors_DataConnector);Connectors_DataConnector.registerType("CSV",CSVConnector);var Connectors_CSVConnector=null&&CSVConnector;var JSONConverter_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var JSONConverter_assign=undefined&&undefined.__assign||function(){JSONConverter_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return JSONConverter_assign.apply(this,arguments)};var error=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().error,JSONConverter_isArray=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().isArray,JSONConverter_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge,JSONConverter_objectEach=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().objectEach;var JSONConverter=function(_super){JSONConverter_extends(JSONConverter,_super);function JSONConverter(options){var _this=this;var mergedOptions=JSONConverter_merge(JSONConverter.defaultOptions,options);_this=_super.call(this,mergedOptions)||this;_this.columns=[];_this.headers=[];_this.options=mergedOptions;_this.table=new Data_DataTable;return _this}JSONConverter.prototype.parse=function(options,eventDetail){var converter=this;options=JSONConverter_merge(converter.options,options);var beforeParse=options.beforeParse,orientation=options.orientation,firstRowAsNames=options.firstRowAsNames,columnNames=options.columnNames;var data=options.data;if(!data){return}converter.columns=[];converter.emit({type:"parse",columns:converter.columns,detail:eventDetail,headers:converter.headers});if(beforeParse){data=beforeParse(data)}data=data.slice();if(orientation==="columns"){for(var i=0,iEnd=data.length;i<iEnd;i++){var item=data[i];if(!(item instanceof Array)){return}if(converter.headers instanceof Array){if(firstRowAsNames){converter.headers.push("".concat(item.shift()))}else if(columnNames&&columnNames instanceof Array){converter.headers.push(columnNames[i])}converter.table.setColumn(converter.headers[i]||i.toString(),item)}else{error("JSONConverter: Invalid `columnNames` option.",false)}}}else if(orientation==="rows"){if(firstRowAsNames){converter.headers=data.shift()}else if(columnNames){converter.headers=columnNames}var _loop_1=function(rowIndex,iEnd){var row=data[rowIndex];if(JSONConverter_isArray(row)){for(var columnIndex=0,jEnd=row.length;columnIndex<jEnd;columnIndex++){if(converter.columns.length<columnIndex+1){converter.columns.push([])}converter.columns[columnIndex].push(row[columnIndex]);if(converter.headers instanceof Array){this_1.table.setColumn(converter.headers[columnIndex]||columnIndex.toString(),converter.columns[columnIndex])}else{error("JSONConverter: Invalid `columnNames` option.",false)}}}else{var columnNames_1=converter.headers;if(columnNames_1&&!(columnNames_1 instanceof Array)){var newRow_1={};JSONConverter_objectEach(columnNames_1,function(arrayWithPath,name){newRow_1[name]=arrayWithPath.reduce(function(acc,key){return acc[key]},row)});row=newRow_1}this_1.table.setRows([row],rowIndex)}};var this_1=this;for(var rowIndex=0,iEnd=data.length;rowIndex<iEnd;rowIndex++){_loop_1(rowIndex,iEnd)}}converter.emit({type:"afterParse",columns:converter.columns,detail:eventDetail,headers:converter.headers})};JSONConverter.prototype.getTable=function(){return this.table};JSONConverter.defaultOptions=JSONConverter_assign(JSONConverter_assign({},Converters_DataConverter.defaultOptions),{data:[],orientation:"rows"});return JSONConverter}(Converters_DataConverter);var Converters_JSONConverter=JSONConverter;var JSONConnector_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var JSONConnector_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge;var JSONConnector=function(_super){JSONConnector_extends(JSONConnector,_super);function JSONConnector(options){var _this=this;var mergedOptions=JSONConnector_merge(JSONConnector.defaultOptions,options);_this=_super.call(this,mergedOptions)||this;_this.converter=new Converters_JSONConverter(mergedOptions);_this.options=mergedOptions;if(mergedOptions.enablePolling){_this.startPolling(Math.max(mergedOptions.dataRefreshRate||0,1)*1e3)}return _this}JSONConnector.prototype.load=function(eventDetail){var connector=this,converter=connector.converter,table=connector.table,_a=connector.options,data=_a.data,dataUrl=_a.dataUrl,dataModifier=_a.dataModifier;connector.emit({type:"load",data:data,detail:eventDetail,table:table});return Promise.resolve(dataUrl?fetch(dataUrl).then(function(json){return json.json()}):data||[]).then(function(data){if(data){table.deleteColumns();converter.parse({data:data});table.setColumns(converter.getTable().getColumns())}return connector.setModifierOptions(dataModifier).then(function(){return data})}).then(function(data){connector.emit({type:"afterLoad",data:data,detail:eventDetail,table:table});return connector})["catch"](function(error){connector.emit({type:"loadError",detail:eventDetail,error:error,table:table});throw error})};JSONConnector.defaultOptions={data:[],enablePolling:false,dataRefreshRate:0,firstRowAsNames:true,orientation:"rows"};return JSONConnector}(Connectors_DataConnector);Connectors_DataConnector.registerType("JSON",JSONConnector);var Connectors_JSONConnector=null&&JSONConnector;var GoogleSheetsConverter_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GoogleSheetsConverter_assign=undefined&&undefined.__assign||function(){GoogleSheetsConverter_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return GoogleSheetsConverter_assign.apply(this,arguments)};var GoogleSheetsConverter_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge,GoogleSheetsConverter_uniqueKey=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().uniqueKey;var GoogleSheetsConverter=function(_super){GoogleSheetsConverter_extends(GoogleSheetsConverter,_super);function GoogleSheetsConverter(options){var _this=this;var mergedOptions=GoogleSheetsConverter_merge(GoogleSheetsConverter.defaultOptions,options);_this=_super.call(this,mergedOptions)||this;_this.columns=[];_this.header=[];_this.options=mergedOptions;return _this}GoogleSheetsConverter.prototype.parse=function(options,eventDetail){var _a;var converter=this,parseOptions=GoogleSheetsConverter_merge(converter.options,options);var columns=(((_a=parseOptions.json)===null||_a===void 0?void 0:_a.values)||[]).map(function(column){return column.slice()});if(columns.length===0){return false}converter.header=[];converter.columns=[];converter.emit({type:"parse",columns:converter.columns,detail:eventDetail,headers:converter.header});var beforeParse=parseOptions.beforeParse,json=parseOptions.json;if(beforeParse&&json){columns=beforeParse(json.values)}var column;converter.columns=columns;for(var i=0,iEnd=columns.length;i<iEnd;i++){column=columns[i];converter.header[i]=parseOptions.firstRowAsNames?"".concat(column.shift()):GoogleSheetsConverter_uniqueKey();for(var j=0,jEnd=column.length;j<jEnd;++j){if(column[j]&&typeof column[j]==="string"){var cellValue=converter.asGuessedType(column[j]);if(cellValue instanceof Date){cellValue=cellValue.getTime()}converter.columns[i][j]=cellValue}}}converter.emit({type:"afterParse",columns:converter.columns,detail:eventDetail,headers:converter.header})};GoogleSheetsConverter.prototype.getTable=function(){return Converters_DataConverter.getTableFromColumns(this.columns,this.header)};GoogleSheetsConverter.defaultOptions=GoogleSheetsConverter_assign({},Converters_DataConverter.defaultOptions);return GoogleSheetsConverter}(Converters_DataConverter);var Converters_GoogleSheetsConverter=GoogleSheetsConverter;var GoogleSheetsConnector_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var GoogleSheetsConnector_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge,GoogleSheetsConnector_pick=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().pick;function isGoogleError(json){return typeof json==="object"&&json&&typeof json.error==="object"&&json.error&&typeof json.error.code==="number"&&typeof json.error.message==="string"&&typeof json.error.status==="string"}var GoogleSheetsConnector=function(_super){GoogleSheetsConnector_extends(GoogleSheetsConnector,_super);function GoogleSheetsConnector(options){var _this=this;var mergedOptions=GoogleSheetsConnector_merge(GoogleSheetsConnector.defaultOptions,options);_this=_super.call(this,mergedOptions)||this;_this.converter=new Converters_GoogleSheetsConverter(mergedOptions);_this.options=mergedOptions;return _this}GoogleSheetsConnector.prototype.load=function(eventDetail){var connector=this,converter=connector.converter,table=connector.table,_a=connector.options,dataModifier=_a.dataModifier,dataRefreshRate=_a.dataRefreshRate,enablePolling=_a.enablePolling,firstRowAsNames=_a.firstRowAsNames,googleAPIKey=_a.googleAPIKey,googleSpreadsheetKey=_a.googleSpreadsheetKey,url=GoogleSheetsConnector.buildFetchURL(googleAPIKey,googleSpreadsheetKey,connector.options);connector.emit({type:"load",detail:eventDetail,table:table,url:url});if(!URL.canParse(url)){throw new Error("Invalid URL: "+url)}return fetch(url).then(function(response){return response.json()}).then(function(json){if(isGoogleError(json)){throw new Error(json.error.message)}converter.parse({firstRowAsNames:firstRowAsNames,json:json});table.deleteColumns();table.setColumns(converter.getTable().getColumns());return connector.setModifierOptions(dataModifier)}).then(function(){connector.emit({type:"afterLoad",detail:eventDetail,table:table,url:url});if(enablePolling){setTimeout(function(){return connector.load()},Math.max(dataRefreshRate||0,1)*1e3)}return connector})["catch"](function(error){connector.emit({type:"loadError",detail:eventDetail,error:error,table:table});throw error})};GoogleSheetsConnector.defaultOptions={googleAPIKey:"",googleSpreadsheetKey:"",enablePolling:false,dataRefreshRate:2,firstRowAsNames:true};return GoogleSheetsConnector}(Connectors_DataConnector);(function(GoogleSheetsConnector){var alphabet="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function buildFetchURL(apiKey,sheetKey,options){if(options===void 0){options={}}var url=new URL("https://sheets.googleapis.com/v4/spreadsheets/".concat(sheetKey,"/values/"));var range=options.onlyColumnNames?"A1:Z1":buildQueryRange(options);url.pathname+=range;var searchParams=url.searchParams;searchParams.set("alt","json");if(!options.onlyColumnNames){searchParams.set("dateTimeRenderOption","FORMATTED_STRING");searchParams.set("majorDimension","COLUMNS");searchParams.set("valueRenderOption","UNFORMATTED_VALUE")}searchParams.set("prettyPrint","false");searchParams.set("key",apiKey);return url.href}GoogleSheetsConnector.buildFetchURL=buildFetchURL;function buildQueryRange(options){if(options===void 0){options={}}var endColumn=options.endColumn,endRow=options.endRow,googleSpreadsheetRange=options.googleSpreadsheetRange,startColumn=options.startColumn,startRow=options.startRow;return googleSpreadsheetRange||(alphabet[startColumn||0]||"A")+(Math.max(startRow||0,0)+1)+":"+(alphabet[GoogleSheetsConnector_pick(endColumn,25)]||"Z")+(endRow?Math.max(endRow,0):"Z")}GoogleSheetsConnector.buildQueryRange=buildQueryRange})(GoogleSheetsConnector||(GoogleSheetsConnector={}));Connectors_DataConnector.registerType("GoogleSheets",GoogleSheetsConnector);var Connectors_GoogleSheetsConnector=null&&GoogleSheetsConnector;var HTMLTableConverter_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var HTMLTableConverter_assign=undefined&&undefined.__assign||function(){HTMLTableConverter_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return HTMLTableConverter_assign.apply(this,arguments)};var HTMLTableConverter_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge;function isRowEqual(row1,row2){var i=row1.length;if(row2.length===i){while(--i){if(row1[i]!==row2[i]){return false}}}else{return false}return true}var HTMLTableConverter=function(_super){HTMLTableConverter_extends(HTMLTableConverter,_super);function HTMLTableConverter(options){var _this=this;var mergedOptions=HTMLTableConverter_merge(HTMLTableConverter.defaultOptions,options);_this=_super.call(this,mergedOptions)||this;_this.columns=[];_this.headers=[];_this.options=mergedOptions;if(mergedOptions.tableElement){_this.tableElement=mergedOptions.tableElement;_this.tableElementID=mergedOptions.tableElement.id}return _this}HTMLTableConverter.prototype.export=function(connector,options){if(options===void 0){options=this.options}var exportNames=options.firstRowAsNames!==false,useMultiLevelHeaders=options.useMultiLevelHeaders;var columns=connector.getSortedColumns(options.usePresentationOrder),columnNames=Object.keys(columns),htmlRows=[],columnsCount=columnNames.length;var rowArray=[];var tableHead="";if(exportNames){var subcategories=[];if(useMultiLevelHeaders){for(var _i=0,columnNames_1=columnNames;_i<columnNames_1.length;_i++){var name_1=columnNames_1[_i];var subhead=(columns[name_1].shift()||"").toString();subcategories.push(subhead)}tableHead=this.getTableHeaderHTML(columnNames,subcategories,options)}else{tableHead=this.getTableHeaderHTML(void 0,columnNames,options)}}for(var columnIndex=0;columnIndex<columnsCount;columnIndex++){var columnName=columnNames[columnIndex],column=columns[columnName],columnLength=column.length;for(var rowIndex=0;rowIndex<columnLength;rowIndex++){var cellValue=column[rowIndex];if(!rowArray[rowIndex]){rowArray[rowIndex]=[]}if(!(typeof cellValue==="string"||typeof cellValue==="number"||typeof cellValue==="undefined")){cellValue=(cellValue||"").toString()}rowArray[rowIndex][columnIndex]=this.getCellHTMLFromValue(columnIndex?"td":"th",null,columnIndex?"":'scope="row"',cellValue);if(columnIndex===columnsCount-1){htmlRows.push("<tr>"+rowArray[rowIndex].join("")+"</tr>")}}}var caption="";if(options.tableCaption){caption='<caption class="highcharts-table-caption">'+options.tableCaption+"</caption>"}return"<table>"+caption+tableHead+"<tbody>"+htmlRows.join("")+"</tbody>"+"</table>"};HTMLTableConverter.prototype.getCellHTMLFromValue=function(tag,classes,attrs,value,decimalPoint){var val=value,className="text"+(classes?" "+classes:"");if(typeof val==="number"){val=val.toString();if(decimalPoint===","){val=val.replace(".",decimalPoint)}className="number"}else if(!value){val="";className="empty"}return"<"+tag+(attrs?" "+attrs:"")+' class="'+className+'">'+val+"</"+tag+">"};HTMLTableConverter.prototype.getTableHeaderHTML=function(topheaders,subheaders,options){if(topheaders===void 0){topheaders=[]}if(subheaders===void 0){subheaders=[]}if(options===void 0){options=this.options}var useMultiLevelHeaders=options.useMultiLevelHeaders,useRowspanHeaders=options.useRowspanHeaders;var html="<thead>",i=0,len=subheaders&&subheaders.length,next,cur,curColspan=0,rowspan;if(useMultiLevelHeaders&&topheaders&&subheaders&&!isRowEqual(topheaders,subheaders)){html+="<tr>";for(;i<len;++i){cur=topheaders[i];next=topheaders[i+1];if(cur===next){++curColspan}else if(curColspan){html+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col" '+'colspan="'+(curColspan+1)+'"',cur);curColspan=0}else{if(cur===subheaders[i]){if(useRowspanHeaders){rowspan=2;delete subheaders[i]}else{rowspan=1;subheaders[i]=""}}else{rowspan=1}html+=this.getCellHTMLFromValue("th","highcharts-table-topheading",'scope="col"'+(rowspan>1?' valign="top" rowspan="'+rowspan+'"':""),cur)}}html+="</tr>"}if(subheaders){html+="<tr>";for(i=0,len=subheaders.length;i<len;++i){if(typeof subheaders[i]!=="undefined"){html+=this.getCellHTMLFromValue("th",null,'scope="col"',subheaders[i])}}html+="</tr>"}html+="</thead>";return html};HTMLTableConverter.prototype.parse=function(options,eventDetail){var converter=this,columns=[],headers=[],parseOptions=HTMLTableConverter_merge(converter.options,options),endRow=parseOptions.endRow,startColumn=parseOptions.startColumn,endColumn=parseOptions.endColumn,firstRowAsNames=parseOptions.firstRowAsNames,tableHTML=parseOptions.tableElement||this.tableElement;if(!(tableHTML instanceof HTMLElement)){converter.emit({type:"parseError",columns:columns,detail:eventDetail,headers:headers,error:"Not a valid HTML Table"});return}converter.tableElement=tableHTML;converter.tableElementID=tableHTML.id;this.emit({type:"parse",columns:converter.columns,detail:eventDetail,headers:converter.headers});var rows=tableHTML.getElementsByTagName("tr"),rowsCount=rows.length;var rowIndex=0,item,startRow=parseOptions.startRow;if(firstRowAsNames&&rowsCount){var items=rows[0].children,itemsLength=items.length;for(var i=startColumn;i<itemsLength;i++){if(i>endColumn){break}item=items[i];if(item.tagName==="TD"||item.tagName==="TH"){headers.push(item.innerHTML)}}startRow++}while(rowIndex<rowsCount){if(rowIndex>=startRow&&rowIndex<=endRow){var columnsInRow=rows[rowIndex].children,columnsInRowLength=columnsInRow.length;var columnIndex=0;while(columnIndex<columnsInRowLength){var relativeColumnIndex=columnIndex-startColumn,row=columns[relativeColumnIndex];item=columnsInRow[columnIndex];if((item.tagName==="TD"||item.tagName==="TH")&&(columnIndex>=startColumn&&columnIndex<=endColumn)){if(!columns[relativeColumnIndex]){columns[relativeColumnIndex]=[]}var cellValue=converter.asGuessedType(item.innerHTML);if(cellValue instanceof Date){cellValue=cellValue.getTime()}columns[relativeColumnIndex][rowIndex-startRow]=cellValue;var i=1;while(rowIndex-startRow>=i&&row[rowIndex-startRow-i]===void 0){row[rowIndex-startRow-i]=null;i++}}columnIndex++}}rowIndex++}this.columns=columns;this.headers=headers;this.emit({type:"afterParse",columns:columns,detail:eventDetail,headers:headers})};HTMLTableConverter.prototype.getTable=function(){return Converters_DataConverter.getTableFromColumns(this.columns,this.headers)};HTMLTableConverter.defaultOptions=HTMLTableConverter_assign(HTMLTableConverter_assign({},Converters_DataConverter.defaultOptions),{useRowspanHeaders:true,useMultiLevelHeaders:true});return HTMLTableConverter}(Converters_DataConverter);var Converters_HTMLTableConverter=HTMLTableConverter;var HTMLTableConnector_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var win=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().win;var HTMLTableConnector_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge;var HTMLTableConnector=function(_super){HTMLTableConnector_extends(HTMLTableConnector,_super);function HTMLTableConnector(options){var _this=this;var mergedOptions=HTMLTableConnector_merge(HTMLTableConnector.defaultOptions,options);_this=_super.call(this,mergedOptions)||this;_this.converter=new Converters_HTMLTableConverter(mergedOptions);_this.options=mergedOptions;return _this}HTMLTableConnector.prototype.load=function(eventDetail){var connector=this,converter=connector.converter,table=connector.table,_a=connector.options,dataModifier=_a.dataModifier,tableHTML=_a.table;connector.emit({type:"load",detail:eventDetail,table:table,tableElement:connector.tableElement});var tableElement;if(typeof tableHTML==="string"){connector.tableID=tableHTML;tableElement=win.document.getElementById(tableHTML)}else{tableElement=tableHTML;connector.tableID=tableElement.id}connector.tableElement=tableElement||void 0;if(!connector.tableElement){var error="HTML table not provided, or element with ID not found";connector.emit({type:"loadError",detail:eventDetail,error:error,table:table});return Promise.reject(new Error(error))}converter.parse(HTMLTableConnector_merge({tableElement:connector.tableElement},connector.options),eventDetail);table.deleteColumns();table.setColumns(converter.getTable().getColumns());return connector.setModifierOptions(dataModifier).then(function(){connector.emit({type:"afterLoad",detail:eventDetail,table:table,tableElement:connector.tableElement});return connector})};HTMLTableConnector.defaultOptions={table:""};return HTMLTableConnector}(Connectors_DataConnector);Connectors_DataConnector.registerType("HTMLTable",HTMLTableConnector);var Connectors_HTMLTableConnector=null&&HTMLTableConnector;var ChainModifier_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __awaiter=undefined&&undefined.__awaiter||function(thisArg,_arguments,P,generator){function adopt(value){return value instanceof P?value:new P(function(resolve){resolve(value)})}return new(P||(P=Promise))(function(resolve,reject){function fulfilled(value){try{step(generator.next(value))}catch(e){reject(e)}}function rejected(value){try{step(generator["throw"](value))}catch(e){reject(e)}}function step(result){result.done?resolve(result.value):adopt(result.value).then(fulfilled,rejected)}step((generator=generator.apply(thisArg,_arguments||[])).next())})};var __generator=undefined&&undefined.__generator||function(thisArg,body){var _={label:0,sent:function(){if(t[0]&1)throw t[1];return t[1]},trys:[],ops:[]},f,y,t,g;return g={next:verb(0),throw:verb(1),return:verb(2)},typeof Symbol==="function"&&(g[Symbol.iterator]=function(){return this}),g;function verb(n){return function(v){return step([n,v])}}function step(op){if(f)throw new TypeError("Generator is already executing.");while(g&&(g=0,op[0]&&(_=0)),_)try{if(f=1,y&&(t=op[0]&2?y["return"]:op[0]?y["throw"]||((t=y["return"])&&t.call(y),0):y.next)&&!(t=t.call(y,op[1])).done)return t;if(y=0,t)op=[op[0]&2,t.value];switch(op[0]){case 0:case 1:t=op;break;case 4:_.label++;return{value:op[1],done:false};case 5:_.label++;y=op[1];op=[0];continue;case 7:op=_.ops.pop();_.trys.pop();continue;default:if(!(t=_.trys,t=t.length>0&&t[t.length-1])&&(op[0]===6||op[0]===2)){_=0;continue}if(op[0]===3&&(!t||op[1]>t[0]&&op[1]<t[3])){_.label=op[1];break}if(op[0]===6&&_.label<t[1]){_.label=t[1];t=op;break}if(t&&_.label<t[2]){_.label=t[2];_.ops.push(op);break}if(t[2])_.ops.pop();_.trys.pop();continue}op=body.call(thisArg,_)}catch(e){op=[6,e];y=0}finally{f=t=0}if(op[0]&5)throw op[1];return{value:op[0]?op[1]:void 0,done:true}}};var ChainModifier_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge;var ChainModifier=function(_super){ChainModifier_extends(ChainModifier,_super);function ChainModifier(options){var chain=[];for(var _i=1;_i<arguments.length;_i++){chain[_i-1]=arguments[_i]}var _this=_super.call(this)||this;_this.chain=chain;_this.options=ChainModifier_merge(ChainModifier.defaultOptions,options);var optionsChain=_this.options.chain||[];for(var i=0,iEnd=optionsChain.length,modifierOptions=void 0,ModifierClass=void 0;i<iEnd;++i){modifierOptions=optionsChain[i];if(!modifierOptions.type){continue}ModifierClass=Modifiers_DataModifier.types[modifierOptions.type];if(ModifierClass){chain.push(new ModifierClass(modifierOptions))}}return _this}ChainModifier.prototype.add=function(modifier,eventDetail){this.emit({type:"addModifier",detail:eventDetail,modifier:modifier});this.chain.push(modifier);this.emit({type:"addModifier",detail:eventDetail,modifier:modifier})};ChainModifier.prototype.clear=function(eventDetail){this.emit({type:"clearChain",detail:eventDetail});this.chain.length=0;this.emit({type:"afterClearChain",detail:eventDetail})};ChainModifier.prototype.modify=function(table,eventDetail){return __awaiter(this,void 0,void 0,function(){var modifiers,modified,i,iEnd,error_1;return __generator(this,function(_a){switch(_a.label){case 0:modifiers=this.options.reverse?this.chain.slice().reverse():this.chain.slice();if(table.modified===table){table.modified=table.clone(false,eventDetail)}modified=table;i=0,iEnd=modifiers.length;_a.label=1;case 1:if(!(i<iEnd))return[3,7];_a.label=2;case 2:_a.trys.push([2,4,,5]);return[4,modifiers[i].modify(modified,eventDetail)];case 3:_a.sent();return[3,5];case 4:error_1=_a.sent();this.emit({type:"error",detail:eventDetail,table:table});throw error_1;case 5:modified=modified.modified;_a.label=6;case 6:++i;return[3,1];case 7:table.modified=modified;return[2,table]}})})};ChainModifier.prototype.modifyCell=function(table,columnName,rowIndex,cellValue,eventDetail){var modifiers=this.options.reverse?this.chain.reverse():this.chain;if(modifiers.length){var clone=table.clone();for(var i=0,iEnd=modifiers.length;i<iEnd;++i){modifiers[i].modifyCell(clone,columnName,rowIndex,cellValue,eventDetail);clone=clone.modified}table.modified=clone}return table};ChainModifier.prototype.modifyColumns=function(table,columns,rowIndex,eventDetail){var modifiers=this.options.reverse?this.chain.reverse():this.chain.slice();if(modifiers.length){var clone=table.clone();for(var i=0,iEnd=modifiers.length;i<iEnd;++i){modifiers[i].modifyColumns(clone,columns,rowIndex,eventDetail);clone=clone.modified}table.modified=clone}return table};ChainModifier.prototype.modifyRows=function(table,rows,rowIndex,eventDetail){var modifiers=this.options.reverse?this.chain.reverse():this.chain.slice();if(modifiers.length){var clone=table.clone();for(var i=0,iEnd=modifiers.length;i<iEnd;++i){modifiers[i].modifyRows(clone,rows,rowIndex,eventDetail);clone=clone.modified}table.modified=clone}return table};ChainModifier.prototype.modifyTable=function(table,eventDetail){var chain=this;chain.emit({type:"modify",detail:eventDetail,table:table});var modifiers=chain.options.reverse?chain.chain.reverse():chain.chain.slice();var modified=table.modified;for(var i=0,iEnd=modifiers.length,modifier=void 0;i<iEnd;++i){modifier=modifiers[i];modified=modifier.modifyTable(modified,eventDetail).modified}table.modified=modified;chain.emit({type:"afterModify",detail:eventDetail,table:table});return table};ChainModifier.prototype.remove=function(modifier,eventDetail){var modifiers=this.chain;this.emit({type:"removeModifier",detail:eventDetail,modifier:modifier});modifiers.splice(modifiers.indexOf(modifier),1);this.emit({type:"afterRemoveModifier",detail:eventDetail,modifier:modifier})};ChainModifier.defaultOptions={type:"Chain"};return ChainModifier}(Modifiers_DataModifier);Modifiers_DataModifier.registerType("Chain",ChainModifier);var Modifiers_ChainModifier=null&&ChainModifier;var InvertModifier_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var InvertModifier_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge;var InvertModifier=function(_super){InvertModifier_extends(InvertModifier,_super);function InvertModifier(options){var _this=_super.call(this)||this;_this.options=InvertModifier_merge(InvertModifier.defaultOptions,options);return _this}InvertModifier.prototype.modifyCell=function(table,columnName,rowIndex,cellValue,eventDetail){var modified=table.modified,modifiedRowIndex=modified.getRowIndexBy("columnNames",columnName);if(typeof modifiedRowIndex==="undefined"){modified.setColumns(this.modifyTable(table.clone()).getColumns(),void 0,eventDetail)}else{modified.setCell("".concat(rowIndex),modifiedRowIndex,cellValue,eventDetail)}return table};InvertModifier.prototype.modifyColumns=function(table,columns,rowIndex,eventDetail){var modified=table.modified,modifiedColumnNames=modified.getColumn("columnNames")||[];var columnNames=table.getColumnNames(),reset=table.getRowCount()!==modifiedColumnNames.length;if(!reset){for(var i=0,iEnd=columnNames.length;i<iEnd;++i){if(columnNames[i]!==modifiedColumnNames[i]){reset=true;break}}}if(reset){return this.modifyTable(table,eventDetail)}columnNames=Object.keys(columns);for(var i=0,iEnd=columnNames.length,column=void 0,columnName=void 0,modifiedRowIndex=void 0;i<iEnd;++i){columnName=columnNames[i];column=columns[columnName];modifiedRowIndex=modified.getRowIndexBy("columnNames",columnName)||modified.getRowCount();for(var j=0,j2=rowIndex,jEnd=column.length;j<jEnd;++j,++j2){modified.setCell("".concat(j2),modifiedRowIndex,column[j],eventDetail)}}return table};InvertModifier.prototype.modifyRows=function(table,rows,rowIndex,eventDetail){var columnNames=table.getColumnNames(),modified=table.modified,modifiedColumnNames=modified.getColumn("columnNames")||[];var reset=table.getRowCount()!==modifiedColumnNames.length;if(!reset){for(var i=0,iEnd=columnNames.length;i<iEnd;++i){if(columnNames[i]!==modifiedColumnNames[i]){reset=true;break}}}if(reset){return this.modifyTable(table,eventDetail)}for(var i=0,i2=rowIndex,iEnd=rows.length,row=void 0;i<iEnd;++i,++i2){row=rows[i];if(row instanceof Array){modified.setColumn("".concat(i2),row)}else{for(var j=0,jEnd=columnNames.length;j<jEnd;++j){modified.setCell("".concat(i2),j,row[columnNames[j]],eventDetail)}}}return table};InvertModifier.prototype.modifyTable=function(table,eventDetail){var modifier=this;modifier.emit({type:"modify",detail:eventDetail,table:table});var modified=table.modified;if(table.hasColumns(["columnNames"])){var columnNames=((table.deleteColumns(["columnNames"])||{}).columnNames||[]).map(function(column){return"".concat(column)}),columns={};for(var i=0,iEnd=table.getRowCount(),row=void 0;i<iEnd;++i){row=table.getRow(i);if(row){columns[columnNames[i]]=row}}modified.deleteColumns();modified.setColumns(columns)}else{var columns={};for(var i=0,iEnd=table.getRowCount(),row=void 0;i<iEnd;++i){row=table.getRow(i);if(row){columns["".concat(i)]=row}}columns.columnNames=table.getColumnNames();modified.deleteColumns();modified.setColumns(columns)}modifier.emit({type:"afterModify",detail:eventDetail,table:table});return table};InvertModifier.defaultOptions={type:"Invert"};return InvertModifier}(Modifiers_DataModifier);Modifiers_DataModifier.registerType("Invert",InvertModifier);var Modifiers_InvertModifier=null&&InvertModifier;var MathModifier_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var MathModifier_assign=undefined&&undefined.__assign||function(){MathModifier_assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return MathModifier_assign.apply(this,arguments)};var MathModifier=function(_super){MathModifier_extends(MathModifier,_super);function MathModifier(options){var _this=_super.call(this)||this;_this.options=MathModifier_assign(MathModifier_assign({},MathModifier.defaultOptions),options);return _this}MathModifier.prototype.modifyTable=function(table,eventDetail){var modifier=this;modifier.emit({type:"modify",detail:eventDetail,table:table});var alternativeSeparators=modifier.options.alternativeSeparators,formulaColumns=modifier.options.formulaColumns||table.getColumnNames(),modified=table.modified;for(var i=0,iEnd=formulaColumns.length,columnName=void 0;i<iEnd;++i){columnName=formulaColumns[i];if(formulaColumns.indexOf(columnName)>=0){modified.setColumn(columnName,modifier.processColumn(table,columnName))}}var columnFormulas=modifier.options.columnFormulas||[];for(var i=0,iEnd=columnFormulas.length,columnFormula=void 0,formula=void 0;i<iEnd;++i){columnFormula=columnFormulas[i];formula=Formula_FormulaParser.parseFormula(columnFormula.formula,alternativeSeparators);modified.setColumn(columnFormula.column,modifier.processColumnFormula(formula,table,columnFormula.rowStart,columnFormula.rowEnd))}modifier.emit({type:"afterModify",detail:eventDetail,table:table});return table};MathModifier.prototype.processColumn=function(table,columnName,rowIndex){if(rowIndex===void 0){rowIndex=0}var alternativeSeparators=this.options.alternativeSeparators,column=(table.getColumn(columnName,true)||[]).slice(rowIndex>0?rowIndex:0);for(var i=0,iEnd=column.length,cacheFormula=[],cacheString="",cell=void 0;i<iEnd;++i){cell=column[i];if(typeof cell==="string"&&cell[0]==="="){try{cacheFormula=cacheString===cell?cacheFormula:Formula_FormulaParser.parseFormula(cell.substring(1),alternativeSeparators);column[i]=Formula_FormulaProcessor.processFormula(cacheFormula,table)}catch(_a){column[i]=NaN}}}return column};MathModifier.prototype.processColumnFormula=function(formula,table,rowStart,rowEnd){if(rowStart===void 0){rowStart=0}if(rowEnd===void 0){rowEnd=table.getRowCount()}rowStart=rowStart>=0?rowStart:0;rowEnd=rowEnd>=0?rowEnd:table.getRowCount()+rowEnd;var column=[],modified=table.modified;for(var i=0,iEnd=rowEnd-rowStart;i<iEnd;++i){try{column[i]=Formula_FormulaProcessor.processFormula(formula,modified)}catch(_a){column[i]=NaN}finally{formula=Formula_FormulaProcessor.translateReferences(formula,0,1)}}return column};MathModifier.defaultOptions={type:"Math",alternativeSeparators:false};return MathModifier}(Modifiers_DataModifier);Modifiers_DataModifier.registerType("Math",MathModifier);var Modifiers_MathModifier=null&&MathModifier;var RangeModifier_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var RangeModifier_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge;var RangeModifier=function(_super){RangeModifier_extends(RangeModifier,_super);function RangeModifier(options){var _this=_super.call(this)||this;_this.options=RangeModifier_merge(RangeModifier.defaultOptions,options);return _this}RangeModifier.prototype.modifyTable=function(table,eventDetail){var modifier=this;modifier.emit({type:"modify",detail:eventDetail,table:table});var indexes=[];var _a=modifier.options,additive=_a.additive,ranges=_a.ranges,strict=_a.strict;if(ranges.length){var modified=table.modified;var columns=table.getColumns(),rows=[];for(var i=0,iEnd=ranges.length,range=void 0,rangeColumn=void 0;i<iEnd;++i){range=ranges[i];if(strict&&typeof range.minValue!==typeof range.maxValue){continue}if(i>0&&!additive){modified.deleteRows();modified.setRows(rows);modified.setOriginalRowIndexes(indexes,true);columns=modified.getColumns();rows=[];indexes=[]}rangeColumn=columns[range.column]||[];for(var j=0,jEnd=rangeColumn.length,cell=void 0,row=void 0,originalRowIndex=void 0;j<jEnd;++j){cell=rangeColumn[j];switch(typeof cell){default:continue;case"boolean":case"number":case"string":break}if(strict&&typeof cell!==typeof range.minValue){continue}if(cell>=range.minValue&&cell<=range.maxValue){if(additive){row=table.getRow(j);originalRowIndex=table.getOriginalRowIndex(j)}else{row=modified.getRow(j);originalRowIndex=modified.getOriginalRowIndex(j)}if(row){rows.push(row);indexes.push(originalRowIndex)}}}}modified.deleteRows();modified.setRows(rows);modified.setOriginalRowIndexes(indexes)}modifier.emit({type:"afterModify",detail:eventDetail,table:table});return table};RangeModifier.defaultOptions={type:"Range",ranges:[]};return RangeModifier}(Modifiers_DataModifier);Modifiers_DataModifier.registerType("Range",RangeModifier);var Modifiers_RangeModifier=null&&RangeModifier;var SortModifier_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var SortModifier_merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge;var SortModifier=function(_super){SortModifier_extends(SortModifier,_super);function SortModifier(options){var _this=_super.call(this)||this;_this.options=SortModifier_merge(SortModifier.defaultOptions,options);return _this}SortModifier.ascending=function(a,b){return(a||0)<(b||0)?-1:(a||0)>(b||0)?1:0};SortModifier.descending=function(a,b){return(b||0)<(a||0)?-1:(b||0)>(a||0)?1:0};SortModifier.prototype.getRowReferences=function(table){var rows=table.getRows(),rowReferences=[];for(var i=0,iEnd=rows.length;i<iEnd;++i){rowReferences.push({index:i,row:rows[i]})}return rowReferences};SortModifier.prototype.modifyCell=function(table,columnName,rowIndex,cellValue,eventDetail){var modifier=this,_a=modifier.options,orderByColumn=_a.orderByColumn,orderInColumn=_a.orderInColumn;if(columnName===orderByColumn){if(orderInColumn){table.modified.setCell(columnName,rowIndex,cellValue);table.modified.setColumn(orderInColumn,modifier.modifyTable(new Data_DataTable({columns:table.getColumns([orderByColumn,orderInColumn])})).modified.getColumn(orderInColumn))}else{modifier.modifyTable(table,eventDetail)}}return table};SortModifier.prototype.modifyColumns=function(table,columns,rowIndex,eventDetail){var modifier=this,_a=modifier.options,orderByColumn=_a.orderByColumn,orderInColumn=_a.orderInColumn,columnNames=Object.keys(columns);if(columnNames.indexOf(orderByColumn)>-1){if(orderInColumn&&columns[columnNames[0]].length){table.modified.setColumns(columns,rowIndex);table.modified.setColumn(orderInColumn,modifier.modifyTable(new Data_DataTable({columns:table.getColumns([orderByColumn,orderInColumn])})).modified.getColumn(orderInColumn))}else{modifier.modifyTable(table,eventDetail)}}return table};SortModifier.prototype.modifyRows=function(table,rows,rowIndex,eventDetail){var modifier=this,_a=modifier.options,orderByColumn=_a.orderByColumn,orderInColumn=_a.orderInColumn;if(orderInColumn&&rows.length){table.modified.setRows(rows,rowIndex);table.modified.setColumn(orderInColumn,modifier.modifyTable(new Data_DataTable({columns:table.getColumns([orderByColumn,orderInColumn])})).modified.getColumn(orderInColumn))}else{modifier.modifyTable(table,eventDetail)}return table};SortModifier.prototype.modifyTable=function(table,eventDetail){var _a;var modifier=this;modifier.emit({type:"modify",detail:eventDetail,table:table});var columnNames=table.getColumnNames(),rowCount=table.getRowCount(),rowReferences=this.getRowReferences(table),_b=modifier.options,direction=_b.direction,orderByColumn=_b.orderByColumn,orderInColumn=_b.orderInColumn,compare=direction==="asc"?SortModifier.ascending:SortModifier.descending,orderByColumnIndex=columnNames.indexOf(orderByColumn),modified=table.modified;if(orderByColumnIndex!==-1){rowReferences.sort(function(a,b){return compare(a.row[orderByColumnIndex],b.row[orderByColumnIndex])})}if(orderInColumn){var column=[];for(var i=0;i<rowCount;++i){column[rowReferences[i].index]=i}modified.setColumns((_a={},_a[orderInColumn]=column,_a))}else{var originalIndexes=[];var rows=[];var rowReference=void 0;for(var i=0;i<rowCount;++i){rowReference=rowReferences[i];originalIndexes.push(modified.getOriginalRowIndex(rowReference.index));rows.push(rowReference.row)}modified.setRows(rows,0);modified.setOriginalRowIndexes(originalIndexes)}modifier.emit({type:"afterModify",detail:eventDetail,table:table});return table};SortModifier.defaultOptions={type:"Sort",direction:"desc",orderByColumn:"y"};return SortModifier}(Modifiers_DataModifier);Modifiers_DataModifier.registerType("Sort",SortModifier);var Modifiers_SortModifier=null&&SortModifier;var G=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default();G.DataConnector=G.DataConnector||Connectors_DataConnector;G.DataConverter=G.DataConverter||Converters_DataConverter;G.DataCursor=G.DataCursor||Data_DataCursor;G.DataModifier=G.DataModifier||Modifiers_DataModifier;G.DataPool=G.DataPool||Data_DataPool;G.DataTable=G.DataTable||Data_DataTable;G.Formula=G.Formula||Formula_Formula;var data_tools_src=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default();__webpack_exports__=__webpack_exports__["default"];return __webpack_exports__}()});