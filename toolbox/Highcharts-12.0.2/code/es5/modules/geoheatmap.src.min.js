(function webpackUniversalModuleDefinition(root,factory){if(typeof exports==="object"&&typeof module==="object")module.exports=factory(require("highcharts"),require("highcharts")["SeriesRegistry"]);else if(typeof define==="function"&&define.amd)define("highcharts/modules/geoheatmap",[["highcharts/highcharts"],["highcharts/highcharts","SeriesRegistry"]],factory);else if(typeof exports==="object")exports["highcharts/modules/geoheatmap"]=factory(require("highcharts"),require("highcharts")["SeriesRegistry"]);else root["Highcharts"]=factory(root["Highcharts"],root["Highcharts"]["SeriesRegistry"])})(this,function(__WEBPACK_EXTERNAL_MODULE__944__,__WEBPACK_EXTERNAL_MODULE__512__){return function(){"use strict";var __webpack_modules__={512:function(module){module.exports=__WEBPACK_EXTERNAL_MODULE__512__},944:function(module){module.exports=__WEBPACK_EXTERNAL_MODULE__944__}};var __webpack_module_cache__={};function __webpack_require__(moduleId){var cachedModule=__webpack_module_cache__[moduleId];if(cachedModule!==undefined){return cachedModule.exports}var module=__webpack_module_cache__[moduleId]={exports:{}};__webpack_modules__[moduleId](module,module.exports,__webpack_require__);return module.exports}!function(){__webpack_require__.n=function(module){var getter=module&&module.__esModule?function(){return module["default"]}:function(){return module};__webpack_require__.d(getter,{a:getter});return getter}}();!function(){__webpack_require__.d=function(exports,definition){for(var key in definition){if(__webpack_require__.o(definition,key)&&!__webpack_require__.o(exports,key)){Object.defineProperty(exports,key,{enumerable:true,get:definition[key]})}}}}();!function(){__webpack_require__.o=function(obj,prop){return Object.prototype.hasOwnProperty.call(obj,prop)}}();var __webpack_exports__={};__webpack_require__.d(__webpack_exports__,{default:function(){return geoheatmap_src}});var highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_=__webpack_require__(944);var highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default=__webpack_require__.n(highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_);var highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_=__webpack_require__(512);var highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_default=__webpack_require__.n(highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_);var __extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(b.hasOwnProperty(p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var MapPoint=highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_default().seriesTypes.map.prototype.pointClass;var isNumber=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().isNumber;var GeoHeatmapPoint=function(_super){__extends(GeoHeatmapPoint,_super);function GeoHeatmapPoint(){return _super!==null&&_super.apply(this,arguments)||this}GeoHeatmapPoint.prototype.applyOptions=function(options,x){var point=_super.prototype.applyOptions.call(this,options,x),_a=point.options,lat=_a.lat,lon=_a.lon;if(isNumber(lon)&&isNumber(lat)){var _b=this.series.options,_c=_b.colsize,colsize=_c===void 0?1:_c,_d=_b.rowsize,rowsize=_d===void 0?1:_d,x1=lon-colsize/2,y1=lat-rowsize/2;point.geometry=point.options.geometry={type:"Polygon",coordinates:[[[x1,y1],[x1+colsize,y1],[x1+colsize,y1+rowsize],[x1,y1+rowsize],[x1,y1]]]}}return point};return GeoHeatmapPoint}(MapPoint);var GeoHeatmap_GeoHeatmapPoint=GeoHeatmapPoint;var doc=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().doc;var defined=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().defined,pick=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().pick;function colorFromPoint(value,point){var colorAxis=point.series.colorAxis;if(colorAxis){var rgba=colorAxis.toColor(value||0,point).split(")")[0].split("(")[1].split(",").map(function(s){return pick(parseFloat(s),parseInt(s,10))});rgba[3]=pick(rgba[3],1)*255;if(!defined(value)||!point.visible){rgba[3]=0}return rgba}return[0,0,0,0]}function getContext(series){var canvas=series.canvas,context=series.context;if(canvas&&context){context.clearRect(0,0,canvas.width,canvas.height)}else{series.canvas=doc.createElement("canvas");series.context=series.canvas.getContext("2d",{willReadFrequently:true})||void 0;return series.context}return context}var InterpolationUtilities={colorFromPoint:colorFromPoint,getContext:getContext};var Series_InterpolationUtilities=InterpolationUtilities;var GeoHeatmapSeries_extends=undefined&&undefined.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var animObject=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().animObject,stop=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().stop;var noop=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().noop;var GeoHeatmapSeries_colorFromPoint=Series_InterpolationUtilities.colorFromPoint,GeoHeatmapSeries_getContext=Series_InterpolationUtilities.getContext;var MapSeries=highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_default().seriesTypes.map;var addEvent=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().addEvent,extend=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().extend,GeoHeatmapSeries_isNumber=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().isNumber,isObject=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().isObject,merge=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().merge,GeoHeatmapSeries_pick=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default().pick;function normalizeLonValue(lon){return lon-Math.floor((lon+180)/360)*360}function scaledPointPos(lon,lat,canvasWidth,canvasHeight,colsize,rowsize){return Math.ceil(canvasWidth*(canvasHeight-1-(lat+90)/rowsize)+(lon+180)/colsize)}var GeoHeatmapSeries=function(_super){GeoHeatmapSeries_extends(GeoHeatmapSeries,_super);function GeoHeatmapSeries(){var _this=_super!==null&&_super.apply(this,arguments)||this;_this.isDirtyCanvas=true;return _this}GeoHeatmapSeries.prototype.update=function(){var series=this;series.options=merge(series.options,arguments[0]);if(series.getInterpolation().enabled){series.isDirtyCanvas=true;series.points.forEach(function(point){if(point.graphic){point.graphic.destroy();delete point.graphic}})}_super.prototype.update.apply(series,arguments)};GeoHeatmapSeries.prototype.translate=function(){if(this.getInterpolation().enabled&&this.image&&!this.isDirty&&!this.isDirtyData){return}_super.prototype.translate.apply(this,arguments)};GeoHeatmapSeries.prototype.getInterpolation=function(){if(!isObject(this.options.interpolation)){return{blur:1,enabled:this.options.interpolation}}return this.options.interpolation};GeoHeatmapSeries.prototype.drawPoints=function(){var series=this,chart=series.chart,mapView=chart.mapView,seriesOptions=series.options;if(series.getInterpolation().enabled&&mapView&&series.bounds){var ctx=series.context||GeoHeatmapSeries_getContext(series),canvas=series.canvas,colorAxis=series.colorAxis,image_1=series.image,chart_1=series.chart,points=series.points,_a=[GeoHeatmapSeries_pick(seriesOptions.colsize,1),GeoHeatmapSeries_pick(seriesOptions.rowsize,1)],colsize=_a[0],rowsize=_a[1],topLeft=mapView.projectedUnitsToPixels({x:series.bounds.x1,y:series.bounds.y2}),bottomRight=mapView.projectedUnitsToPixels({x:series.bounds.x2,y:series.bounds.y1});if(canvas&&ctx&&colorAxis&&topLeft&&bottomRight){var dimensions_1={x:topLeft.x,y:topLeft.y,width:bottomRight.x-topLeft.x,height:bottomRight.y-topLeft.y};if(series.isDirtyCanvas||series.isDirtyData||mapView.projection.options.name==="Orthographic"){series.isDirtyCanvas=true;var canvasWidth=canvas.width=~~(360/colsize)+1,canvasHeight=canvas.height=~~(180/rowsize)+1,canvasArea=canvasWidth*canvasHeight,pixelData=new Uint8ClampedArray(canvasArea*4);series.directTouch=false;for(var i=0;i<points.length;i++){var p=points[i],sourceArr=new Uint8ClampedArray(GeoHeatmapSeries_colorFromPoint(p.value,p)),_b=p.options,lon=_b.lon,lat=_b.lat;if(GeoHeatmapSeries_isNumber(lon)&&GeoHeatmapSeries_isNumber(lat)){pixelData.set(sourceArr,scaledPointPos(lon,lat,canvasWidth,canvasHeight,colsize,rowsize)*4)}}var blur_1=series.getInterpolation().blur,blurFactor=blur_1===0?1:blur_1*11,upscaledWidth=~~(canvasWidth*blurFactor),upscaledHeight=~~(canvasHeight*blurFactor),projectedWidth=~~dimensions_1.width,projectedHeight=~~dimensions_1.height,img=new ImageData(pixelData,canvasWidth,canvasHeight);canvas.width=upscaledWidth;canvas.height=upscaledHeight;ctx.putImageData(img,0,0);ctx.globalCompositeOperation="copy";ctx.drawImage(canvas,0,0,img.width,img.height,0,0,canvas.width,canvas.height);var cartesianImageData=ctx.getImageData(0,0,canvas.width,canvas.height),projectedPixelData=this.getProjectedImageData(mapView,projectedWidth,projectedHeight,cartesianImageData,canvas,dimensions_1.x,dimensions_1.y),projectedImg=new ImageData(projectedPixelData,projectedWidth,projectedHeight);ctx.globalCompositeOperation="copy";canvas.width=projectedWidth;canvas.height=projectedHeight;ctx.putImageData(projectedImg,0,0)}if(image_1){if(chart_1.renderer.globalAnimation&&chart_1.hasRendered){var startX_1=Number(image_1.attr("x")),startY_1=Number(image_1.attr("y")),startWidth_1=Number(image_1.attr("width")),startHeight_1=Number(image_1.attr("height"));var step_1=function(now,fx){image_1.attr({x:startX_1+(dimensions_1.x-startX_1)*fx.pos,y:startY_1+(dimensions_1.y-startY_1)*fx.pos,width:startWidth_1+(dimensions_1.width-startWidth_1)*fx.pos,height:startHeight_1+(dimensions_1.height-startHeight_1)*fx.pos})};var animOptions=merge(animObject(chart_1.renderer.globalAnimation)),userStep_1=animOptions.step;animOptions.step=function(){if(userStep_1){userStep_1.apply(this,arguments)}step_1.apply(this,arguments)};image_1.attr(merge({animator:0},series.isDirtyCanvas?{href:canvas.toDataURL("image/png",1)}:void 0)).animate({animator:1},animOptions)}else{stop(image_1);image_1.attr(merge(dimensions_1,series.isDirtyCanvas?{href:canvas.toDataURL("image/png",1)}:void 0))}}else{series.image=chart_1.renderer.image(canvas.toDataURL("image/png",1)).attr(dimensions_1).add(series.group)}series.isDirtyCanvas=false}}else{_super.prototype.drawPoints.apply(series,arguments)}};GeoHeatmapSeries.prototype.getProjectedImageData=function(mapView,projectedWidth,projectedHeight,cartesianImageData,canvas,horizontalShift,verticalShift){var _a;var projectedPixelData=new Uint8ClampedArray(projectedWidth*projectedHeight*4),lambda=GeoHeatmapSeries_pick((_a=mapView.projection.options.rotation)===null||_a===void 0?void 0:_a[0],0),widthFactor=canvas.width/360,heightFactor=-1*canvas.height/180;var y=-1;for(var i=0;i<projectedPixelData.length;i+=4){var x=i/4%projectedWidth;if(x===0){y++}var projectedCoords=mapView.pixelsToLonLat({x:horizontalShift+x,y:verticalShift+y});if(projectedCoords){if(projectedCoords.lon>-180-lambda&&projectedCoords.lon<180-lambda){projectedCoords.lon=normalizeLonValue(projectedCoords.lon)}var projected=[projectedCoords.lon,projectedCoords.lat],cvs2PixelX=projected[0]*widthFactor+canvas.width/2,cvs2PixelY=projected[1]*heightFactor+canvas.height/2;if(cvs2PixelX>=0&&cvs2PixelX<=canvas.width&&cvs2PixelY>=0&&cvs2PixelY<=canvas.height){var redPos=Math.floor(cvs2PixelY)*canvas.width*4+Math.round(cvs2PixelX)*4;projectedPixelData[i]=cartesianImageData.data[redPos];projectedPixelData[i+1]=cartesianImageData.data[redPos+1];projectedPixelData[i+2]=cartesianImageData.data[redPos+2];projectedPixelData[i+3]=cartesianImageData.data[redPos+3]}}}return projectedPixelData};GeoHeatmapSeries.prototype.searchPoint=function(e,compareX){var series=this,chart=this.chart,mapView=chart.mapView;if(mapView&&series.bounds&&series.image&&chart.tooltip&&chart.tooltip.options.enabled){if(!chart.pointer.hasDragged&&(+series.image.attr("animator")<=.01||+series.image.attr("animator")>=.99)){var topLeft=mapView.projectedUnitsToPixels({x:series.bounds.x1,y:series.bounds.y2}),bottomRight=mapView.projectedUnitsToPixels({x:series.bounds.x2,y:series.bounds.y1});chart.pointer.normalize(e);if(e.lon&&e.lat&&topLeft&&bottomRight&&e.chartX-chart.plotLeft>topLeft.x&&e.chartX-chart.plotLeft<bottomRight.x&&e.chartY-chart.plotTop>topLeft.y&&e.chartY-chart.plotTop<bottomRight.y){return this.searchKDTree({clientX:e.chartX,lon:normalizeLonValue(e.lon),lat:e.lat},compareX,e)}}else{chart.tooltip.destroy()}}};GeoHeatmapSeries.defaultOptions=merge(MapSeries.defaultOptions,{nullColor:"transparent",tooltip:{pointFormat:"Lat: {point.lat}, Lon: {point.lon}, Value: {point.value}<br/>"},borderWidth:0,colsize:1,rowsize:1,stickyTracking:true,interpolation:{enabled:false,blur:1}});return GeoHeatmapSeries}(MapSeries);addEvent(GeoHeatmapSeries,"afterDataClassLegendClick",function(){this.isDirtyCanvas=true;this.drawPoints()});extend(GeoHeatmapSeries.prototype,{type:"geoheatmap",applyJitter:noop,pointClass:GeoHeatmap_GeoHeatmapPoint,pointArrayMap:["lon","lat","value"],kdAxisArray:["lon","lat"]});highcharts_SeriesRegistry_commonjs_highcharts_SeriesRegistry_commonjs2_highcharts_SeriesRegistry_root_Highcharts_SeriesRegistry_default().registerSeriesType("geoheatmap",GeoHeatmapSeries);var GeoHeatmap_GeoHeatmapSeries=null&&GeoHeatmapSeries;"";var geoheatmap_src=highcharts_commonjs_highcharts_commonjs2_highcharts_root_Highcharts_default();__webpack_exports__=__webpack_exports__["default"];return __webpack_exports__}()});