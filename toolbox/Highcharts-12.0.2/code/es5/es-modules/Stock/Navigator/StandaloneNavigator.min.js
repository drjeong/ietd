"use strict";import Chart from"../../Core/Chart/Chart.js";import Navigator from"./Navigator.js";import G from"../../Core/Globals.js";import U from"../../Core/Utilities.js";import Axis from"../../Core/Axis/Axis.js";import standaloneNavigatorDefaults from"./StandaloneNavigatorDefaults.js";var merge=U.merge,addEvent=U.addEvent,fireEvent=U.fireEvent,pick=U.pick;var StandaloneNavigator=function(){function StandaloneNavigator(element,userOptions){this.boundAxes=[];this.userOptions=userOptions;this.chartOptions=merge(G.getOptions(),standaloneNavigatorDefaults,{navigator:userOptions});if(this.chartOptions.chart&&userOptions.height){this.chartOptions.chart.height=userOptions.height}var chart=new Chart(element,this.chartOptions);chart.options=merge(chart.options,{navigator:{enabled:true},scrollbar:{enabled:true}});if(this.chartOptions.navigator&&this.chartOptions.scrollbar){this.chartOptions.navigator.enabled=true;this.chartOptions.scrollbar.enabled=true}this.navigator=new Navigator(chart);chart.navigator=this.navigator;this.initNavigator()}StandaloneNavigator.navigator=function(renderTo,options){var nav=new StandaloneNavigator(renderTo,options);if(!G.navigators){G.navigators=[nav]}else{G.navigators.push(nav)}return nav};StandaloneNavigator.prototype.bind=function(axisOrChart,twoWay){var _this=this;if(twoWay===void 0){twoWay=true}var nav=this;var axis=axisOrChart instanceof Chart?axisOrChart.xAxis[0]:axisOrChart;if(!(axis instanceof Axis)){return}var _a=this.navigator.xAxis,min=_a.min,max=_a.max,removeEventCallbacks=[];if(twoWay){var removeSetExtremesEvent=addEvent(axis,"setExtremes",function(e){if(e.trigger==="pan"||e.trigger==="zoom"||e.trigger==="mouseWheelZoom"){nav.setRange(e.min,e.max,true,e.trigger!=="pan",{trigger:axis})}});removeEventCallbacks.push(removeSetExtremesEvent)}var removeSetRangeEvent=addEvent(this.navigator,"setRange",function(e){axis.setExtremes(e.min,e.max,e.redraw,e.animation)});removeEventCallbacks.push(removeSetRangeEvent);var boundAxis=this.boundAxes.filter(function(boundAxis){return boundAxis.axis===axis})[0];if(!boundAxis){boundAxis={axis:axis,callbacks:[]};this.boundAxes.push(boundAxis)}boundAxis.callbacks=removeEventCallbacks;axis.series.forEach(function(series){if(series.options.showInNavigator){nav.addSeries(series.options)}});axis.setExtremes(min,max);addEvent(axis,"destroy",function(e){if(!e.keepEvents){_this.unbind(axis)}})};StandaloneNavigator.prototype.unbind=function(axisOrChart){if(!axisOrChart){this.boundAxes.forEach(function(_a){var callbacks=_a.callbacks;callbacks.forEach(function(removeCallback){return removeCallback()})});this.boundAxes.length=0;return}var axis=axisOrChart instanceof Axis?axisOrChart:axisOrChart.xAxis[0];for(var i=this.boundAxes.length-1;i>=0;i--){if(this.boundAxes[i].axis===axis){this.boundAxes[i].callbacks.forEach(function(callback){return callback()});this.boundAxes.splice(i,1)}}};StandaloneNavigator.prototype.destroy=function(){this.boundAxes.forEach(function(_a){var callbacks=_a.callbacks;callbacks.forEach(function(removeCallback){return removeCallback()})});this.boundAxes.length=0;this.navigator.destroy();this.navigator.chart.destroy()};StandaloneNavigator.prototype.update=function(newOptions,redraw){this.chartOptions=merge(this.chartOptions,newOptions.height&&{chart:{height:newOptions.height}},{navigator:newOptions});this.navigator.chart.update(this.chartOptions,redraw)};StandaloneNavigator.prototype.redraw=function(){this.navigator.chart.redraw()};StandaloneNavigator.prototype.addSeries=function(seriesOptions){this.navigator.chart.addSeries(merge(seriesOptions,{showInNavigator:pick(seriesOptions.showInNavigator,true)}));this.navigator.setBaseSeries()};StandaloneNavigator.prototype.initNavigator=function(){var _a;var nav=this.navigator;nav.top=1;nav.xAxis.setScale();nav.yAxis.setScale();nav.xAxis.render();nav.yAxis.render();(_a=nav.series)===null||_a===void 0?void 0:_a.forEach(function(s){s.translate();s.render();s.redraw()});var _b=this.getInitialExtremes(),min=_b.min,max=_b.max;nav.chart.xAxis[0].userMin=min;nav.chart.xAxis[0].userMax=max;nav.render(min,max)};StandaloneNavigator.prototype.getRange=function(){var _a=this.navigator.chart.xAxis[0].getExtremes(),min=_a.min,max=_a.max,_b=this.navigator.xAxis.getExtremes(),userMin=_b.userMin,userMax=_b.userMax,dataMin=_b.min,dataMax=_b.max;return{min:pick(min,dataMin),max:pick(max,dataMax),dataMin:dataMin,dataMax:dataMax,userMin:userMin,userMax:userMax}};StandaloneNavigator.prototype.setRange=function(min,max,redraw,animation,eventArguments){fireEvent(this.navigator,"setRange",{min:min,max:max,redraw:redraw,animation:animation,eventArguments:merge(eventArguments,{trigger:"navigator"})})};StandaloneNavigator.prototype.getInitialExtremes=function(){var _a=this.navigator.xAxis.getExtremes(),min=_a.min,max=_a.max;return{min:min,max:max}};return StandaloneNavigator}();export default StandaloneNavigator;"";