"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();var __assign=this&&this.__assign||function(){__assign=Object.assign||function(t){for(var s,i=1,n=arguments.length;i<n;i++){s=arguments[i];for(var p in s)if(Object.prototype.hasOwnProperty.call(s,p))t[p]=s[p]}return t};return __assign.apply(this,arguments)};import A from"../../Core/Animation/AnimationUtilities.js";var setAnimation=A.setAnimation;import Point from"../../Core/Series/Point.js";import U from"../../Core/Utilities.js";var addEvent=U.addEvent,defined=U.defined,extend=U.extend,isNumber=U.isNumber,pick=U.pick,relativeLength=U.relativeLength;var PiePoint=function(_super){__extends(PiePoint,_super);function PiePoint(series,options,x){var _a;var _this=_super.call(this,series,options,x)||this;_this.half=0;(_a=_this.name)!==null&&_a!==void 0?_a:_this.name="Slice";var toggleSlice=function(e){_this.slice(e.type==="select")};addEvent(_this,"select",toggleSlice);addEvent(_this,"unselect",toggleSlice);return _this}PiePoint.prototype.getConnectorPath=function(dataLabel){var labelPosition=dataLabel.dataLabelPosition,options=dataLabel.options||{},connectorShape=options.connectorShape,shapeFunc=this.connectorShapes[connectorShape]||connectorShape;return labelPosition&&shapeFunc.call(this,__assign(__assign({},labelPosition.computed),{alignment:labelPosition.alignment}),labelPosition.connectorPosition,options)||[]};PiePoint.prototype.getTranslate=function(){return this.sliced&&this.slicedTranslation||{translateX:0,translateY:0}};PiePoint.prototype.haloPath=function(size){var shapeArgs=this.shapeArgs;return this.sliced||!this.visible?[]:this.series.chart.renderer.symbols.arc(shapeArgs.x,shapeArgs.y,shapeArgs.r+size,shapeArgs.r+size,{innerR:shapeArgs.r-1,start:shapeArgs.start,end:shapeArgs.end,borderRadius:shapeArgs.borderRadius})};PiePoint.prototype.isValid=function(){return isNumber(this.y)&&this.y>=0};PiePoint.prototype.setVisible=function(vis,redraw){if(redraw===void 0){redraw=true}if(vis!==this.visible){this.update({visible:vis!==null&&vis!==void 0?vis:!this.visible},redraw,void 0,false)}};PiePoint.prototype.slice=function(sliced,redraw,animation){var series=this.series,chart=series.chart;setAnimation(animation,chart);redraw=pick(redraw,true);this.sliced=this.options.sliced=sliced=defined(sliced)?sliced:!this.sliced;series.options.data[series.data.indexOf(this)]=this.options;if(this.graphic){this.graphic.animate(this.getTranslate())}};return PiePoint}(Point);extend(PiePoint.prototype,{connectorShapes:{fixedOffset:function(labelPosition,connectorPosition,options){var breakAt=connectorPosition.breakAt,touchingSliceAt=connectorPosition.touchingSliceAt,lineSegment=options.softConnector?["C",labelPosition.x+(labelPosition.alignment==="left"?-5:5),labelPosition.y,2*breakAt.x-touchingSliceAt.x,2*breakAt.y-touchingSliceAt.y,breakAt.x,breakAt.y]:["L",breakAt.x,breakAt.y];return[["M",labelPosition.x,labelPosition.y],lineSegment,["L",touchingSliceAt.x,touchingSliceAt.y]]},straight:function(labelPosition,connectorPosition){var touchingSliceAt=connectorPosition.touchingSliceAt;return[["M",labelPosition.x,labelPosition.y],["L",touchingSliceAt.x,touchingSliceAt.y]]},crookedLine:function(labelPosition,connectorPosition,options){var _a=connectorPosition.angle,angle=_a===void 0?this.angle||0:_a,breakAt=connectorPosition.breakAt,touchingSliceAt=connectorPosition.touchingSliceAt,series=this.series,_b=series.center,cx=_b[0],cy=_b[1],diameter=_b[2],r=diameter/2,_c=series.chart,plotLeft=_c.plotLeft,plotWidth=_c.plotWidth,leftAligned=labelPosition.alignment==="left",x=labelPosition.x,y=labelPosition.y;var crookX=breakAt.x;if(options.crookDistance){var crookDistance=relativeLength(options.crookDistance,1);crookX=leftAligned?cx+r+(plotWidth+plotLeft-cx-r)*(1-crookDistance):plotLeft+(cx-r)*crookDistance}else{crookX=cx+(cy-y)*Math.tan(angle-Math.PI/2)}var path=[["M",x,y]];if(leftAligned?crookX<=x&&crookX>=breakAt.x:crookX>=x&&crookX<=breakAt.x){path.push(["L",crookX,y])}path.push(["L",breakAt.x,breakAt.y],["L",touchingSliceAt.x,touchingSliceAt.y]);return path}}});export default PiePoint;