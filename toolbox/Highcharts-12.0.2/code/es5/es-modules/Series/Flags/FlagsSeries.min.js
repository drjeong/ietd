"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();import FlagsPoint from"./FlagsPoint.js";import FlagsSeriesDefaults from"./FlagsSeriesDefaults.js";import FlagsSymbols from"./FlagsSymbols.js";import H from"../../Core/Globals.js";var noop=H.noop;import OnSeriesComposition from"../OnSeriesComposition.js";import R from"../../Core/Renderer/RendererUtilities.js";var distribute=R.distribute;import SeriesRegistry from"../../Core/Series/SeriesRegistry.js";var Series=SeriesRegistry.series,ColumnSeries=SeriesRegistry.seriesTypes.column;import SVGElement from"../../Core/Renderer/SVG/SVGElement.js";import U from"../../Core/Utilities.js";var addEvent=U.addEvent,defined=U.defined,extend=U.extend,isNumber=U.isNumber,merge=U.merge,objectEach=U.objectEach,wrap=U.wrap;var FlagsSeries=function(_super){__extends(FlagsSeries,_super);function FlagsSeries(){return _super!==null&&_super.apply(this,arguments)||this}FlagsSeries.prototype.animate=function(init){if(init){this.setClip()}};FlagsSeries.prototype.drawPoints=function(){var _a,_b;var series=this,points=series.points,chart=series.chart,renderer=chart.renderer,inverted=chart.inverted,options=series.options,optionsY=options.y,yAxis=series.yAxis,boxesMap={},boxes=[],borderRadius=isNumber(options.borderRadius)?options.borderRadius:0;var plotX,plotY,shape,i,point,graphic,stackIndex,anchorY,attribs,outsideRight,centered;i=points.length;while(i--){point=points[i];outsideRight=(inverted?point.plotY:point.plotX)>series.xAxis.len;plotX=point.plotX;stackIndex=point.stackIndex;shape=point.options.shape||options.shape;plotY=point.plotY;if(typeof plotY!=="undefined"){plotY=point.plotY+optionsY-(typeof stackIndex!=="undefined"&&stackIndex*options.stackDistance)}point.anchorX=stackIndex?void 0:point.plotX;anchorY=stackIndex?void 0:point.plotY;centered=shape!=="flag";graphic=point.graphic;if(typeof plotY!=="undefined"&&plotX>=0&&!outsideRight){if(graphic&&point.hasNewShapeType()){graphic=graphic.destroy()}if(!graphic){graphic=point.graphic=renderer.label("",0,void 0,shape,void 0,void 0,options.useHTML).addClass("highcharts-point").add(series.markerGroup);if(point.graphic.div){point.graphic.div.point=point}graphic.isNew=true}graphic.attr({align:centered?"center":"left",width:options.width,height:options.height,"text-align":options.textAlign,r:borderRadius});if(!chart.styledMode){graphic.attr(series.pointAttribs(point)).css(merge(options.style,point.style)).shadow(options.shadow)}if(plotX>0){plotX-=graphic.strokeWidth()%2}attribs={y:plotY,anchorY:anchorY};if(options.allowOverlapX){attribs.x=plotX;attribs.anchorX=point.anchorX}graphic.attr({text:(_b=(_a=point.options.title)!==null&&_a!==void 0?_a:options.title)!==null&&_b!==void 0?_b:"A"})[graphic.isNew?"attr":"animate"](attribs);if(!options.allowOverlapX){if(!boxesMap[point.plotX]){boxesMap[point.plotX]={align:centered?.5:0,size:graphic.width||0,target:plotX,anchorX:plotX}}else{boxesMap[point.plotX].size=Math.max(boxesMap[point.plotX].size,graphic.width||0)}}point.tooltipPos=[plotX,plotY+yAxis.pos-chart.plotTop]}else if(graphic){point.graphic=graphic.destroy()}}if(!options.allowOverlapX){var maxDistance_1=100;objectEach(boxesMap,function(box){box.plotX=box.anchorX;boxes.push(box);maxDistance_1=Math.max(box.size,maxDistance_1)});distribute(boxes,inverted?yAxis.len:this.xAxis.len,maxDistance_1);for(var _i=0,points_1=points;_i<points_1.length;_i++){var point_1=points_1[_i];var plotX_1=point_1.plotX,graphic_1=point_1.graphic,box=graphic_1&&boxesMap[plotX_1];if(box&&graphic_1){if(!defined(box.pos)){graphic_1.hide().isNew=true}else{graphic_1[graphic_1.isNew?"attr":"animate"]({x:box.pos+(box.align||0)*box.size,anchorX:point_1.anchorX}).show().isNew=false}}}}if(options.useHTML&&series.markerGroup){wrap(series.markerGroup,"on",function(proceed){return SVGElement.prototype.on.apply(proceed.apply(this,[].slice.call(arguments,1)),[].slice.call(arguments,1))})}};FlagsSeries.prototype.drawTracker=function(){var series=this,points=series.points;_super.prototype.drawTracker.call(this);var _loop_1=function(point){var graphic=point.graphic;if(graphic){if(point.unbindMouseOver){point.unbindMouseOver()}point.unbindMouseOver=addEvent(graphic.element,"mouseover",function(){if(point.stackIndex>0&&!point.raised){point._y=graphic.y;graphic.attr({y:point._y-8});point.raised=true}for(var _i=0,points_3=points;_i<points_3.length;_i++){var otherPoint=points_3[_i];if(otherPoint!==point&&otherPoint.raised&&otherPoint.graphic){otherPoint.graphic.attr({y:otherPoint._y});otherPoint.raised=false}}})}};for(var _i=0,points_2=points;_i<points_2.length;_i++){var point=points_2[_i];_loop_1(point)}};FlagsSeries.prototype.pointAttribs=function(point,state){var options=this.options,color=point&&point.color||this.color;var lineColor=options.lineColor,lineWidth=point&&point.lineWidth,fill=point&&point.fillColor||options.fillColor;if(state){fill=options.states[state].fillColor;lineColor=options.states[state].lineColor;lineWidth=options.states[state].lineWidth}return{fill:fill||color,stroke:lineColor||color,"stroke-width":lineWidth||options.lineWidth||0}};FlagsSeries.prototype.setClip=function(){Series.prototype.setClip.apply(this,arguments);if(this.options.clip!==false&&this.sharedClipKey&&this.markerGroup){this.markerGroup.clip(this.chart.sharedClips[this.sharedClipKey])}};FlagsSeries.compose=FlagsSymbols.compose;FlagsSeries.defaultOptions=merge(ColumnSeries.defaultOptions,FlagsSeriesDefaults);return FlagsSeries}(ColumnSeries);OnSeriesComposition.compose(FlagsSeries);extend(FlagsSeries.prototype,{allowDG:false,forceCrop:true,invertible:false,noSharedTooltip:true,pointClass:FlagsPoint,sorted:false,takeOrdinalPosition:false,trackerGroups:["markerGroup"],buildKDTree:noop,init:Series.prototype.init});SeriesRegistry.registerSeriesType("flags",FlagsSeries);export default FlagsSeries;"";