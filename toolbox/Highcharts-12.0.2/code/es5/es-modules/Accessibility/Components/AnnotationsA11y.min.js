"use strict";import HTMLUtilities from"../Utils/HTMLUtilities.js";var escapeStringForHTML=HTMLUtilities.escapeStringForHTML,stripHTMLTagsFromString=HTMLUtilities.stripHTMLTagsFromString;function getChartAnnotationLabels(chart){var annotations=chart.annotations||[];return annotations.reduce(function(acc,cur){if(cur.options&&cur.options.visible!==false){acc=acc.concat(cur.labels)}return acc},[])}function getLabelText(label){return label.options&&label.options.accessibility&&label.options.accessibility.description||label.graphic&&label.graphic.text&&label.graphic.text.textStr||""}function getAnnotationLabelDescription(label){var a11yDesc=label.options&&label.options.accessibility&&label.options.accessibility.description;if(a11yDesc){return a11yDesc}var chart=label.chart;var labelText=getLabelText(label);var points=label.points;var getAriaLabel=function(point){return point.graphic&&point.graphic.element&&point.graphic.element.getAttribute("aria-label")||""};var getValueDesc=function(point){var valDesc=point.accessibility&&point.accessibility.valueDescription||getAriaLabel(point);var seriesName=point&&point.series.name||"";return(seriesName?seriesName+", ":"")+"data point "+valDesc};var pointValueDescriptions=points.filter(function(p){return!!p.graphic}).map(getValueDesc).filter(function(desc){return!!desc});var numPoints=pointValueDescriptions.length;var pointsSelector=numPoints>1?"MultiplePoints":numPoints?"SinglePoint":"NoPoints";var langFormatStr="accessibility.screenReaderSection.annotations.description"+pointsSelector;var context={annotationText:labelText,annotation:label,numPoints:numPoints,annotationPoint:pointValueDescriptions[0],additionalAnnotationPoints:pointValueDescriptions.slice(1)};return chart.langFormat(langFormatStr,context)}function getAnnotationListItems(chart){var labels=getChartAnnotationLabels(chart);return labels.map(function(label){var desc=escapeStringForHTML(stripHTMLTagsFromString(getAnnotationLabelDescription(label),chart.renderer.forExport));return desc?"<li>".concat(desc,"</li>"):""})}function getAnnotationsInfoHTML(chart){var annotations=chart.annotations;if(!(annotations&&annotations.length)){return""}var annotationItems=getAnnotationListItems(chart);return'<ul style="list-style-type: none">'.concat(annotationItems.join(" "),"</ul>")}function getPointAnnotationTexts(point){var labels=getChartAnnotationLabels(point.series.chart);var pointLabels=labels.filter(function(label){return label.points.indexOf(point)>-1});if(!pointLabels.length){return[]}return pointLabels.map(function(label){return"".concat(getLabelText(label))})}var AnnotationsA11y={getAnnotationsInfoHTML:getAnnotationsInfoHTML,getAnnotationLabelDescription:getAnnotationLabelDescription,getAnnotationListItems:getAnnotationListItems,getPointAnnotationTexts:getPointAnnotationTexts};export default AnnotationsA11y;