"use strict";import U from"../../Core/Utilities.js";var pick=U.pick;var SonificationSpeaker=function(){function SonificationSpeaker(options){this.options=options;this.masterVolume=1;this.synthesis=window.speechSynthesis;if(typeof speechSynthesis.onvoiceschanged!=="undefined"){speechSynthesis.onvoiceschanged=this.setVoice.bind(this)}this.setVoice();this.scheduled=[]}SonificationSpeaker.prototype.say=function(message,options){if(this.synthesis){this.synthesis.cancel();var utterance=new SpeechSynthesisUtterance(message);if(this.voice){utterance.voice=this.voice}utterance.rate=options&&options.rate||this.options.rate||1;utterance.pitch=options&&options.pitch||this.options.pitch||1;utterance.volume=pick(options&&options.volume,this.options.volume,1)*this.masterVolume;this.synthesis.speak(utterance)}};SonificationSpeaker.prototype.sayAtTime=function(time,message,options){this.scheduled.push(setTimeout(this.say.bind(this,message,options),time))};SonificationSpeaker.prototype.cancel=function(){this.scheduled.forEach(clearTimeout);this.scheduled=[];this.synthesis.cancel()};SonificationSpeaker.prototype.destroy=function(){this.cancel()};SonificationSpeaker.prototype.setMasterVolume=function(vol){this.masterVolume=vol};SonificationSpeaker.prototype.setVoice=function(){if(this.synthesis){var name_1=this.options.name,lang=this.options.language||"en-US",voices=this.synthesis.getVoices(),len=voices.length;var langFallback=void 0;for(var i=0;i<len;++i){if(name_1&&voices[i].name===name_1){this.voice=voices[i];return}if(!langFallback&&voices[i].lang===lang){langFallback=voices[i];if(!name_1){break}}}this.voice=langFallback}};return SonificationSpeaker}();export default SonificationSpeaker;"";