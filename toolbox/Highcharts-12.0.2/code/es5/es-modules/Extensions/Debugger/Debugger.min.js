"use strict";import D from"../../Core/Defaults.js";var setOptions=D.setOptions;import ErrorMessages from"./ErrorMessages.js";import H from"../../Core/Globals.js";var composed=H.composed;import U from"../../Core/Utilities.js";var addEvent=U.addEvent,find=U.find,isNumber=U.isNumber,pushUnique=U.pushUnique;var defaultOptions={chart:{displayErrors:true}};function compose(ChartClass){if(pushUnique(composed,"Debugger")){addEvent(ChartClass,"beforeRedraw",onChartBeforeRedraw);addEvent(H,"displayError",onHighchartsDisplayError);setOptions(defaultOptions)}}function onChartBeforeRedraw(){var errorElements=this.errorElements;if(errorElements&&errorElements.length){for(var _i=0,errorElements_1=errorElements;_i<errorElements_1.length;_i++){var el=errorElements_1[_i];el.destroy()}}delete this.errorElements}function onHighchartsDisplayError(e){var chart=e.chart||find(this.charts.slice().reverse(),function(c){return!!c});if(!chart){return}var code=e.code,options=chart.options.chart,renderer=chart.renderer;var msg,chartWidth,chartHeight;if(chart.errorElements){for(var _i=0,_a=chart.errorElements;_i<_a.length;_i++){var el=_a[_i];if(el){el.destroy()}}}if(options&&options.displayErrors&&renderer){chart.errorElements=[];msg=isNumber(code)?"Highcharts error #"+code+": "+ErrorMessages[code].text:code;chartWidth=chart.chartWidth;chartHeight=chart.chartHeight;msg=msg.replace(/<h1>(.*)<\/h1>/g,'<br><span style="font-size: 2em">$1</span><br>').replace(/<p>/g,"").replace(/<\/p>/g,"<br>");chart.errorElements[0]=renderer.rect(2,2,chartWidth-4,chartHeight-4).attr({"stroke-width":4,stroke:"#ff0000",zIndex:3}).add();chart.errorElements[1]=renderer.label(msg,0,0,"rect",void 0,void 0,void 0,void 0,"debugger").css({color:"#ffffff",fontSize:"0.8em",width:chartWidth-16+"px",padding:0}).attr({fill:"rgba(255, 0, 0, 0.9)",width:chartWidth,padding:8,zIndex:10}).add();chart.errorElements[1].attr({y:chartHeight-chart.errorElements[1].getBBox().height})}}var Debugger={compose:compose};export default Debugger;