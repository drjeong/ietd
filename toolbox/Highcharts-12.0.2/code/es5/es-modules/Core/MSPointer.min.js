"use strict";var __extends=this&&this.__extends||function(){var extendStatics=function(d,b){extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)if(Object.prototype.hasOwnProperty.call(b,p))d[p]=b[p]};return extendStatics(d,b)};return function(d,b){if(typeof b!=="function"&&b!==null)throw new TypeError("Class extends value "+String(b)+" is not a constructor or null");extendStatics(d,b);function __(){this.constructor=d}d.prototype=b===null?Object.create(b):(__.prototype=b.prototype,new __)}}();import H from"./Globals.js";var charts=H.charts,composed=H.composed,doc=H.doc,noop=H.noop,win=H.win;import Pointer from"./Pointer.js";import U from"./Utilities.js";var addEvent=U.addEvent,attr=U.attr,css=U.css,defined=U.defined,objectEach=U.objectEach,pick=U.pick,pushUnique=U.pushUnique,removeEvent=U.removeEvent;var touches={};var hasPointerEvent=!!win.PointerEvent;function getWebkitTouches(){var fake=[];fake.item=function(i){return this[i]};objectEach(touches,function(touch){fake.push({pageX:touch.pageX,pageY:touch.pageY,target:touch.target})});return fake}function translateMSPointer(e,method,wktype,func){var _a,_b;var pointer=(_b=charts[(_a=Pointer.hoverChartIndex)!==null&&_a!==void 0?_a:-1])===null||_b===void 0?void 0:_b.pointer;if(pointer&&(e.pointerType==="touch"||e.pointerType===e.MSPOINTER_TYPE_TOUCH)){func(e);pointer[method]({type:wktype,target:e.currentTarget,preventDefault:noop,touches:getWebkitTouches()})}}var MSPointer=function(_super){__extends(MSPointer,_super);function MSPointer(chart,options){var _this=_super.call(this,chart,options)||this;if(_this.hasZoom){css(chart.container,{"-ms-touch-action":"none","touch-action":"none"})}return _this}MSPointer.isRequired=function(){return!!(!win.TouchEvent&&(win.PointerEvent||win.MSPointerEvent))};MSPointer.prototype.batchMSEvents=function(fn){fn(this.chart.container,hasPointerEvent?"pointerdown":"MSPointerDown",this.onContainerPointerDown);fn(this.chart.container,hasPointerEvent?"pointermove":"MSPointerMove",this.onContainerPointerMove);fn(doc,hasPointerEvent?"pointerup":"MSPointerUp",this.onDocumentPointerUp)};MSPointer.prototype.destroy=function(){this.batchMSEvents(removeEvent);_super.prototype.destroy.call(this)};MSPointer.prototype.inClass=function(element,className){var elem=element,elemClassName;while(elem){elemClassName=attr(elem,"class");if(elemClassName){if(elemClassName.indexOf(className)!==-1){return true}if(elemClassName.indexOf("highcharts-container")!==-1){return false}}elem=elem.parentNode;if(elem&&(elem===document.documentElement||defined(elem.nodeType)&&elem.nodeType===document.nodeType)){elem=null}}};MSPointer.prototype.onContainerPointerDown=function(e){translateMSPointer(e,"onContainerTouchStart","touchstart",function(e){touches[e.pointerId]={pageX:e.pageX,pageY:e.pageY,target:e.currentTarget}})};MSPointer.prototype.onContainerPointerMove=function(e){translateMSPointer(e,"onContainerTouchMove","touchmove",function(e){touches[e.pointerId]={pageX:e.pageX,pageY:e.pageY};if(!touches[e.pointerId].target){touches[e.pointerId].target=e.currentTarget}})};MSPointer.prototype.onDocumentPointerUp=function(e){translateMSPointer(e,"onDocumentTouchEnd","touchend",function(e){delete touches[e.pointerId]})};MSPointer.prototype.setDOMEvents=function(){var tooltip=this.chart.tooltip;_super.prototype.setDOMEvents.call(this);if(this.hasZoom||pick(tooltip&&tooltip.options.followTouchMove,true)){this.batchMSEvents(addEvent)}};return MSPointer}(Pointer);(function(MSPointer){function compose(ChartClass){if(pushUnique(composed,"Core.MSPointer")){addEvent(ChartClass,"beforeRender",function(){this.pointer=new MSPointer(this,this.options)})}}MSPointer.compose=compose})(MSPointer||(MSPointer={}));export default MSPointer;