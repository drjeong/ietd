"use strict";import H from"../../../Core/Globals.js";const{doc,isFirefox}=H;import U from"../../../Core/Utilities.js";const{createElement,isArray,isObject,objectEach,pick,stableSort}=U;function addForm(chart,options,callback,isInit){if(!chart){return}const popupDiv=this.container,lang=this.lang;let lhsCol=createElement("h2",{className:"highcharts-popup-main-title"},void 0,popupDiv);lhsCol.appendChild(doc.createTextNode(lang[options.langKey]||options.langKey||""));lhsCol=createElement("div",{className:"highcharts-popup-lhs-col highcharts-popup-lhs-full"},void 0,popupDiv);const bottomRow=createElement("div",{className:"highcharts-popup-bottom-row"},void 0,popupDiv);addFormFields.call(this,lhsCol,chart,"",options,[],true);this.addButton(bottomRow,isInit?lang.addButton||"Add":lang.saveButton||"Save",isInit?"add":"save",popupDiv,callback)}function addToolbar(chart,options,callback){const lang=this.lang,popupDiv=this.container,showForm=this.showForm,toolbarClass="highcharts-annotation-toolbar";if(popupDiv.className.indexOf(toolbarClass)===-1){popupDiv.className+=" "+toolbarClass+" highcharts-no-mousewheel"}if(chart){popupDiv.style.top=chart.plotTop+10+"px"}const label=createElement("p",{className:"highcharts-annotation-label"},void 0,popupDiv);label.setAttribute("aria-label","Annotation type");label.appendChild(doc.createTextNode(pick(lang[options.langKey]||options.langKey,options.shapes&&options.shapes[0].type,"")));let button=this.addButton(popupDiv,lang.editButton||"Edit","edit",popupDiv,()=>{showForm.call(this,"annotation-edit",chart,options,callback)});button.className+=" highcharts-annotation-edit-button";button.style["background-image"]="url("+this.iconsURL+"edit.svg)";button=this.addButton(popupDiv,lang.removeButton||"Remove","remove",popupDiv,callback);button.className+=" highcharts-annotation-remove-button";button.style["background-image"]="url("+this.iconsURL+"destroy.svg)"}function addFormFields(parentDiv,chart,parentNode,options,storage,isRoot){if(!chart){return}const addInput=this.addInput,lang=this.lang;let parentFullName,titleName;objectEach(options,(value,option)=>{parentFullName=parentNode!==""?parentNode+"."+option:option;if(isObject(value)){if(!isArray(value)||isArray(value)&&isObject(value[0])){titleName=lang[option]||option;if(!titleName.match(/\d/g)){storage.push([true,titleName,parentDiv])}addFormFields.call(this,parentDiv,chart,parentFullName,value,storage,false)}else{storage.push([this,parentFullName,"annotation",parentDiv,value])}}});if(isRoot){stableSort(storage,a=>a[1].match(/format/g)?-1:1);if(isFirefox){storage.reverse()}storage.forEach(genInput=>{if(genInput[0]===true){createElement("span",{className:"highcharts-annotation-title"},void 0,genInput[2]).appendChild(doc.createTextNode(genInput[1]))}else{genInput[4]={value:genInput[4][0],type:genInput[4][1]};addInput.apply(genInput[0],genInput.splice(1))}})}}const PopupAnnotations={addForm:addForm,addToolbar:addToolbar};export default PopupAnnotations;