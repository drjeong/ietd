"use strict";import U from"../../Core/Utilities.js";const{pick}=U;class SonificationSpeaker{constructor(options){this.options=options;this.masterVolume=1;this.synthesis=window.speechSynthesis;if(typeof speechSynthesis.onvoiceschanged!=="undefined"){speechSynthesis.onvoiceschanged=this.setVoice.bind(this)}this.setVoice();this.scheduled=[]}say(message,options){if(this.synthesis){this.synthesis.cancel();const utterance=new SpeechSynthesisUtterance(message);if(this.voice){utterance.voice=this.voice}utterance.rate=options&&options.rate||this.options.rate||1;utterance.pitch=options&&options.pitch||this.options.pitch||1;utterance.volume=pick(options&&options.volume,this.options.volume,1)*this.masterVolume;this.synthesis.speak(utterance)}}sayAtTime(time,message,options){this.scheduled.push(setTimeout(this.say.bind(this,message,options),time))}cancel(){this.scheduled.forEach(clearTimeout);this.scheduled=[];this.synthesis.cancel()}destroy(){this.cancel()}setMasterVolume(vol){this.masterVolume=vol}setVoice(){if(this.synthesis){const name=this.options.name,lang=this.options.language||"en-US",voices=this.synthesis.getVoices(),len=voices.length;let langFallback;for(let i=0;i<len;++i){if(name&&voices[i].name===name){this.voice=voices[i];return}if(!langFallback&&voices[i].lang===lang){langFallback=voices[i];if(!name){break}}}this.voice=langFallback}}}export default SonificationSpeaker;"";