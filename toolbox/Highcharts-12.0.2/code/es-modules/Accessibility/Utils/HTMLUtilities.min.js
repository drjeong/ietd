"use strict";import H from"../../Core/Globals.js";const{doc,win}=H;import U from"../../Core/Utilities.js";const{css}=U;const simulatedEventTarget=win.EventTarget&&new win.EventTarget||"none";function addClass(el,className){if(el.classList){el.classList.add(className)}else if(el.className.indexOf(className)<0){el.className+=" "+className}}function removeClass(el,className){if(el.classList){el.classList.remove(className)}else{el.className=el.className.replace(new RegExp(className,"g"),"")}}function cloneMouseEvent(e){if(typeof win.MouseEvent==="function"){return new win.MouseEvent(e.type,e)}if(doc.createEvent){const evt=doc.createEvent("MouseEvent");if(evt.initMouseEvent){evt.initMouseEvent(e.type,e.bubbles,e.cancelable,e.view||win,e.detail,e.screenX,e.screenY,e.clientX,e.clientY,e.ctrlKey,e.altKey,e.shiftKey,e.metaKey,e.button,e.relatedTarget);return evt}}return getFakeMouseEvent(e.type)}function cloneTouchEvent(e){const touchListToTouchArray=l=>{const touchArray=[];for(let i=0;i<l.length;++i){const item=l.item(i);if(item){touchArray.push(item)}}return touchArray};if(typeof win.TouchEvent==="function"){const newEvent=new win.TouchEvent(e.type,{touches:touchListToTouchArray(e.touches),targetTouches:touchListToTouchArray(e.targetTouches),changedTouches:touchListToTouchArray(e.changedTouches),ctrlKey:e.ctrlKey,shiftKey:e.shiftKey,altKey:e.altKey,metaKey:e.metaKey,bubbles:e.bubbles,cancelable:e.cancelable,composed:e.composed,detail:e.detail,view:e.view});if(e.defaultPrevented){newEvent.preventDefault()}return newEvent}const fakeEvt=cloneMouseEvent(e);fakeEvt.touches=e.touches;fakeEvt.changedTouches=e.changedTouches;fakeEvt.targetTouches=e.targetTouches;return fakeEvt}function escapeStringForHTML(str){return str.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")}function getElement(id){return doc.getElementById(id)}function getFakeMouseEvent(type,position,relatedTarget){const pos=position||{x:0,y:0};if(typeof win.MouseEvent==="function"){return new win.MouseEvent(type,{bubbles:true,cancelable:true,composed:true,button:0,buttons:1,relatedTarget:relatedTarget||simulatedEventTarget,view:win,detail:type==="click"?1:0,screenX:pos.x,screenY:pos.y,clientX:pos.x,clientY:pos.y})}if(doc.createEvent){const evt=doc.createEvent("MouseEvent");if(evt.initMouseEvent){evt.initMouseEvent(type,true,true,win,type==="click"?1:0,pos.x,pos.y,pos.x,pos.y,false,false,false,false,0,null);return evt}}return{type:type}}function getHeadingTagNameForElement(element){const getIncreasedHeadingLevel=tagName=>{const headingLevel=parseInt(tagName.slice(1),10),newLevel=Math.min(6,headingLevel+1);return"h"+newLevel};const isHeading=tagName=>/^H[1-6]$/i.test(tagName);const getPreviousSiblingsHeading=el=>{let sibling=el;while(sibling=sibling.previousSibling){const tagName=sibling.tagName||"";if(isHeading(tagName)){return tagName}}return""};const getHeadingRecursive=el=>{const prevSiblingsHeading=getPreviousSiblingsHeading(el);if(prevSiblingsHeading){return getIncreasedHeadingLevel(prevSiblingsHeading)}const parent=el.parentElement;if(!parent){return"h6"}const parentTagName=parent.tagName;if(isHeading(parentTagName)){return getIncreasedHeadingLevel(parentTagName)}return getHeadingRecursive(parent)};return getHeadingRecursive(element)}function removeElement(element){if(element&&element.parentNode){element.parentNode.removeChild(element)}}function removeChildNodes(element){while(element.lastChild){element.removeChild(element.lastChild)}}function reverseChildNodes(node){let i=node.childNodes.length;while(i--){node.appendChild(node.childNodes[i])}}function stripHTMLTagsFromString(str,isForExport=false){return typeof str==="string"?isForExport?str.replace(/<\/?[^>]+(>|$)/g,""):str.replace(/<\/?(?!\s)[^>]+(>|$)/g,""):str}function visuallyHideElement(element){css(element,{position:"absolute",width:"1px",height:"1px",overflow:"hidden",whiteSpace:"nowrap",clip:"rect(1px, 1px, 1px, 1px)",marginTop:"-3px","-ms-filter":"progid:DXImageTransform.Microsoft.Alpha(Opacity=1)",filter:"alpha(opacity=1)",opacity:.01})}const HTMLUtilities={addClass:addClass,cloneMouseEvent:cloneMouseEvent,cloneTouchEvent:cloneTouchEvent,escapeStringForHTML:escapeStringForHTML,getElement:getElement,getFakeMouseEvent:getFakeMouseEvent,getHeadingTagNameForElement:getHeadingTagNameForElement,removeChildNodes:removeChildNodes,removeClass:removeClass,removeElement:removeElement,reverseChildNodes:reverseChildNodes,simulatedEventTarget:simulatedEventTarget,stripHTMLTagsFromString:stripHTMLTagsFromString,visuallyHideElement:visuallyHideElement};export default HTMLUtilities;